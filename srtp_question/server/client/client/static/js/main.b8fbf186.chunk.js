(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{284:function(e,t,n){},317:function(e,t){},318:function(e,t){},319:function(e,t){},320:function(e,t){},321:function(e,t){},353:function(e,t,n){"use strict";n.r(t),n.d(t,"PRIMARY_COLOR",(function(){return er}));var a=n(9),r=n(1),c=(n(280),n(12)),i=n(0),s=n.n(i),o=n(29),l=n.n(o),d=(n(284),n(21));function u(){var e=Object(d.a)(["\n  mutation LogIn($input: LogInInput) {\n    logIn(input: $input) {\n      ... on UserViewer {\n        token\n        name\n        userName\n        gender\n        education\n        jobStatus\n        age\n        marriageStatus\n        didRequest\n        catelogy\n      }\n      ... on AdminViewer {\n        name\n        userName\n        didRequest\n        token\n        catelogy\n      }\n    }\n  }\n"]);return u=function(){return e},e}Object(c.gql)(u());function j(){var e=Object(d.a)(["\n  mutation Logout {\n    logOut {\n      ... on UserViewer {\n        id\n        token\n        didRequest\n        catelogy\n      }\n      ... on AdminViewer {\n        id\n        token\n        didRequest\n        catelogy\n      }\n    }\n  }\n"]);return j=function(){return e},e}Object(c.gql)(j());function b(){var e=Object(d.a)(["\n  mutation CreateAccount($input: CreateAccountInput) {\n    createAccount(input: $input) {\n      token\n      name\n      userName\n      gender\n      education\n      jobStatus\n      marriageStatus\n      didRequest\n      age\n      catelogy\n    }\n  }\n"]);return b=function(){return e},e}Object(c.gql)(b());function O(){var e=Object(d.a)(["\n  mutation SaveUserAnswer($input: UserAnswerInput) {\n    saveUserAnswer(input: $input) {\n      didRequest\n    }\n  }\n"]);return O=function(){return e},e}var h=Object(c.gql)(O());function m(){var e=Object(d.a)(["\n  mutation SavePartialAnswer($input: UserAnswerInput) {\n    savePartialAnswer(input: $input) {\n      didRequest\n    }\n  }\n"]);return m=function(){return e},e}var f=Object(c.gql)(m());function p(){var e=Object(d.a)(["\n  mutation DoctorLogOut {\n    doctorLogOut {\n      didRequest\n    }\n  }\n"]);return p=function(){return e},e}var x=Object(c.gql)(p());function g(){var e=Object(d.a)(["\n  mutation DoctorLogIn($input: DoctorLoginInput) {\n    doctorLogIn(input: $input) {\n      name\n      userName\n      didRequest\n    }\n  }\n"]);return g=function(){return e},e}var v=Object(c.gql)(g());function C(){var e=Object(d.a)(["\n  mutation AddDiagnosis($input: AddDiagnosisInput) {\n    addDiagnosis(input: $input) {\n      result\n    }\n  }\n"]);return C=function(){return e},e}var y=Object(c.gql)(C());function w(){var e=Object(d.a)(["\n  mutation AddDoctor($input: AddDoctorInput) {\n    addDoctor(input: $input) {\n      result\n    }\n  }\n"]);return w=function(){return e},e}var N=Object(c.gql)(w()),I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,447)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},S=n(45),k=n(40),T=n(15),R=n(388),L=n(438),A=n(397),q=n(398),D=n(439),F=n(393),E=n(257),z=function(e){var t=e.isAuthorized,n=e.children,a=Object(E.a)(e,["isAuthorized","children"]);return Object(r.jsx)(k.b,Object(T.a)(Object(T.a)({},a),{},{render:function(e){var a=e.location;return t?n:Object(r.jsx)(k.a,{to:{pathname:"/login",state:{from:a}}})}}))},P=n(391),W=Object(R.a)((function(e){return{root:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"}}})),U=function(){var e=W();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsx)(P.a,{})})},M=n(437),B=n(434),$=function(e){var t=e.showError,n=e.setShowError,a=e.errorMessage;return Object(r.jsx)(M.a,{open:t,onClose:function(){return n(!1)},children:Object(r.jsx)(B.a,{elevation:6,variant:"filled",severity:"error",onClose:function(){return n(!1)},children:a})})},H=n(104),Q=n(357),_=n(392),V=n(133),J=n(209),K=n.n(J),G=n(211),Y=n.n(G),X=n(208),Z=n.n(X),ee=n(210),te=n.n(ee);H.c.GlobalWorkerOptions.workerSrc="/pdf.worker.js";var ne=Object(R.a)((function(e){return Object(L.a)({root:{display:"flex",justifyContent:"center",marginTop:10},paper:{marginBottom:10},pdfViewer:{},topbar:{height:48,display:"flex",justifyContent:"space-between"},returnButton:{marginLeft:5},downloadButton:{marginRight:5},printIcon:{},page:{padding:3}})})),ae=function(e){var t=e.pdfData,n=e.closeReport,c=ne(),o=s.a.useState(window.innerWidth),l=Object(a.a)(o,2),d=l[0],u=l[1],j=function(){window.innerWidth!==d&&u(window.innerWidth)};s.a.useEffect((function(){return window.addEventListener("resize",j),function(){return window.removeEventListener("resize",j)}}));var b=Object(i.useState)(0),O=Object(a.a)(b,2),h=O[0],m=O[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:c.topbar,children:[Object(r.jsx)(Q.a,{onClick:n,className:c.returnButton,children:Object(r.jsx)(K.a,{})}),Object(r.jsxs)("div",{children:[Object(r.jsx)(Q.a,{className:c.printIcon,onClick:function(){Z()({printable:"".concat(t),type:"pdf",base64:!0})},children:Object(r.jsx)(te.a,{})}),Object(r.jsx)("a",{download:"\u5fc3\u7406\u8bc4\u4f30\u62a5\u544a\u5355",href:"data:application/pdf;base64,".concat(t),title:"\u4e0b\u8f7d\u5fc3\u7406\u8bc4\u4f30\u62a5\u544a\u5355",children:Object(r.jsx)(Q.a,{className:c.downloadButton,children:Object(r.jsx)(Y.a,{})})})]})]}),Object(r.jsx)(_.a,{})]}),Object(r.jsx)("div",{className:c.root,children:Object(r.jsx)(H.a,{file:"data:application/pdf;base64,".concat(t),loading:Object(r.jsx)("div",{}),className:c.pdfViewer,onLoadSuccess:function(e){var t=e.numPages;m(t)},children:Array.from(new Array(h),(function(e,t){return Object(r.jsx)(V.a,{elevation:3,className:c.paper,children:Object(r.jsx)(H.b,{pageNumber:t+1,loading:Object(r.jsx)(r.Fragment,{}),renderMode:"svg",width:document.getElementById("root")?.8*(document.getElementById("root").offsetWidth>750?document.getElementById("root").offsetWidth-240:document.getElementById("root").offsetWidth):1e3})},t)}))})})]})},re=n(212),ce=n.n(re),ie=Object(R.a)((function(e){return Object(L.a)({header:{overflow:"hidden"},actionContainer:{float:"right",paddingRight:10,paddingTop:10,fontSize:"0.875rem",display:"flex",alignItems:"center"}})})),se=function(){var e=ie();return Object(r.jsx)("div",{className:e.header,children:Object(r.jsx)("span",{className:e.actionContainer,children:Object(r.jsx)(S.b,{to:"/",children:Object(r.jsx)(F.a,{color:"secondary",startIcon:Object(r.jsx)(ce.a,{}),children:"\u8fd4\u56de\u4e3b\u9875"})})})})},oe=n(150),le=n.n(oe),de=(n(324),Object(R.a)((function(e){return Object(L.a)({canvasContainer:{width:550,height:400}})}))),ue=function(e){var t=e.labelList,n=e.dataList,a=e.multipleDataList,c=e.showLabel,s=de(),o=Object(i.useRef)(null),l=Object(i.useRef)((function(){if(o.current){var e=o.current.getContext("2d");e&&new le.a(e,{type:"line",data:{labels:t,datasets:a||[{label:"\u5f97\u5206",data:n,borderColor:"#0d47a1",backgroundColor:"#bbdefb",fill:!1,lineTension:0}]},options:{tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},maintainAspectRatio:!1,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0}}]},plugins:{datalabels:{anchor:"start",align:"top",formatter:Math.round,display:!!c}}}})}}));return Object(i.useEffect)((function(){l.current()}),[]),Object(r.jsx)("div",{className:s.canvasContainer,children:Object(r.jsx)("canvas",{id:"line-chart",ref:o})})},je=n(394),be=n(395),Oe=n(396),he=n(119),me=n.n(he),fe="\u827e\u68ee\u514b\u4e2a\u6027\u6d4b\u8bd5\uff08EPQ\uff09",pe="\u827e\u68ee\u514b\u4e2a\u6027\u6d4b\u8bd5\u513f\u7ae5\u7248\uff08EPQ\uff09",xe="yale-brown",ge=[fe,pe],ve=[],Ce=function(e){var t=e.formResultList,n=e.formName,c=e.formKey,s=Object(i.useMemo)((function(){return t.map((function(e){return e.fillInDate}))}),[t]),o=Object(i.useMemo)((function(){return"90\u9879\u75c7\u72b6\u6e05\u5355\uff08SCL-90\uff09"===n?t.map((function(e){return Number(JSON.parse(e.result).total)})):t.map((function(e){return Number(e.result)}))}),[t,n]),l=Object(i.useMemo)((function(){return n===fe||n===pe?[{label:"E\u91cf\u8868\u5f97\u5206",data:t.map((function(e){var t=JSON.parse(e.result);return Number(t.eTScore)})),borderColor:"#0d47a1",backgroundColor:"#0d47a1",lineTension:0,fill:!1},{label:"P\u91cf\u8868\u5f97\u5206",data:t.map((function(e){var t=JSON.parse(e.result);return Number(t.pTScore)})),borderColor:"#4caf50",backgroundColor:"#4caf50",fill:!1,lineTension:0},{label:"N\u91cf\u8868\u5f97\u5206",data:t.map((function(e){var t=JSON.parse(e.result);return Number(t.nTScore)})),borderColor:"#ffeb3b",backgroundColor:"#ffeb3b",fill:!1,lineTension:0},{label:"L\u91cf\u8868\u5f97\u5206",data:t.map((function(e){var t=JSON.parse(e.result);return Number(t.lTScore)})),borderColor:"#d32f2f",backgroundColor:"#d32f2f",fill:!1,lineTension:0}]:c===xe?[{label:"\u5f3a\u8feb\u601d\u7ef4\u90e8\u5206\u5206\u6570",data:t.map((function(e){return JSON.parse(e.result).yaleBrownMind})),borderColor:"#0d47a1",backgroundColor:"#0d47a1",lineTension:0,fill:!1},{label:"\u5f3a\u8feb\u884c\u4e3a\u90e8\u5206\u5206\u6570",data:t.map((function(e){return JSON.parse(e.result).yaleBrownBehavior})),borderColor:"#4caf50",backgroundColor:"#4caf50",fill:!1,lineTension:0},{label:"\u4e24\u90e8\u5206\u603b\u5206",data:t.map((function(e){return JSON.parse(e.result).yaleBrownTotal})),borderColor:"#d32f2f",backgroundColor:"#d32f2f",fill:!1,lineTension:0}]:void 0}),[c,n,t]),d=!0;(ge.includes(n)||ve.includes(c))&&(d=!1);var u=Object(i.useState)(!1),j=Object(a.a)(u,2),b=j[0],O=j[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsx)(F.a,{startIcon:Object(r.jsx)(me.a,{}),size:"small",color:"primary",disabled:t.length<=1,onClick:function(){O(!0)},children:"\u8d8b\u52bf"})}),Object(r.jsxs)(je.a,{onClose:function(){O(!1)},open:b,children:[Object(r.jsxs)(be.a,{children:[n,"\u5206\u6570\u8d8b\u52bf"]}),Object(r.jsx)(Oe.a,{children:Object(r.jsx)(ue,{labelList:s,dataList:o,multipleDataList:l,showLabel:d})})]})]})},ye=n.p+"static/media/logo.bcf589ff.png",we=Object(R.a)((function(e){return Object(L.a)({logInCard:{borderRadius:8,width:"min(450px, 90%)",margin:"0 auto 0"},logInText:{fontSize:"1.5rem",textAlign:"center",marginBottom:20,marginTop:25},promptText:{marginBottom:24,fontSize:"1rem",textAlign:"center"},input:{width:"100%"},inputContainer:{margin:"0 40px"},userNameInput:{marginBottom:15},passwordInput:{marginBottom:30},buttonContainer:{display:"flex",justifyContent:"center"},logo:{height:92},logoContainer:{display:"flex",justifyContent:"center"},pageContainer:{backgroundColor:"#f5f5f5",width:"100%",height:"100%"},topPadding:{height:"min(100px, 30%)"}})})),Ne={userName:"",password:""},Ie=function(e){var t=e.isAuthorized,n=(e.setViewer,e.setDoctor),s=e.doctor,o=we(),l=Object(c.useMutation)(v,{onCompleted:function(e){if(e&&e.doctorLogIn){var t=e.doctorLogIn,a=t.name,r=t.userName,c=t.didRequest;n({name:a,userName:r,didRequest:c}),L(!1)}},onError:function(e){w(!0)}}),d=Object(a.a)(l,1)[0],u=Object(i.useRef)(d),j=Object(i.useState)(Ne),b=Object(a.a)(j,2),O=b[0],h=b[1],m=Object(i.useState)(!1),f=Object(a.a)(m,2),p=f[0],x=f[1],g=Object(i.useState)(!1),C=Object(a.a)(g,2),y=C[0],w=C[1],N=function(e){"Enter"===e.key&&z()};Object(i.useEffect)((function(){return window.addEventListener("keydown",N),function(){window.removeEventListener("keydown",N)}}));var I=Object(i.useState)(!0),S=Object(a.a)(I,2),R=S[0],L=S[1],E=Object(i.useRef)((function(){P.location.state&&"/doctor"===P.location.state.from.pathname?L(!0):L(!1)}));Object(i.useEffect)((function(){E.current()}),[]);var z=function(){x(!0),O.userName&&O.password&&u.current({variables:{input:{userName:O.userName,password:O.password}}})},P=Object(k.g)(),W=!(!P.location.state||!P.location.state.from.pathname.includes("doctor"));return t&&!R?W?s.userName?Object(r.jsx)(k.a,{to:"/doctor/".concat(s.userName)}):Object(r.jsx)(U,{}):Object(r.jsx)(k.a,{to:"/user"}):Object(r.jsxs)("div",{className:o.pageContainer,children:[Object(r.jsx)("div",{className:o.topPadding}),Object(r.jsx)(A.a,{className:o.logInCard,children:Object(r.jsxs)(q.a,{children:[Object(r.jsx)("div",{className:o.logoContainer,children:Object(r.jsx)("img",{src:ye,className:o.logo,alt:"\u533b\u9662\u6807\u5fd7"})}),Object(r.jsx)("div",{className:o.logInText,children:W?"\u533b\u751f\u7aef":"\u7528\u6237\u7aef"}),Object(r.jsx)("div",{className:o.promptText,children:"\u8bf7\u8f93\u5165\u533b\u751f\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801"}),Object(r.jsxs)("form",{children:[Object(r.jsxs)("div",{className:o.inputContainer,children:[Object(r.jsx)(D.a,{autoFocus:!0,className:o.input+" "+o.userNameInput,color:"primary",value:O.userName,label:"\u7528\u6237\u540d",onChange:function(e){h(Object(T.a)(Object(T.a)({},O),{},{userName:e.target.value}))},helperText:p&&!O.userName?"\u8bf7\u8f93\u5165\u60a8\u7684\u7528\u6237\u540d":void 0,error:!(!p||O.userName)||void 0,inputProps:{"aira-label":"\u7528\u6237\u540d"}}),Object(r.jsx)(D.a,{className:o.input+" "+o.passwordInput,color:"primary",value:O.password,label:"\u5bc6\u7801",helperText:p&&!O.password?"\u8bf7\u8f93\u5165\u60a8\u7684\u5bc6\u7801":void 0,error:!(!p||O.password)||void 0,onChange:function(e){h(Object(T.a)(Object(T.a)({},O),{},{password:e.target.value}))},type:"password",inputProps:{"aira-label":"\u5bc6\u7801"}})]}),Object(r.jsx)("div",{className:o.buttonContainer,children:Object(r.jsx)(F.a,{variant:"contained",color:"primary",onClick:z,children:"\u767b\u5f55"})})]})]})}),Object(r.jsx)($,{showError:y,setShowError:w,errorMessage:"\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u6b63\u786e\uff01"})]})},Se=n(406),ke=n(403),Te=n(407),Re=n(359),Le=n(408),Ae=n(409),qe=n(410),De=n(411),Fe=n(213),Ee=n.n(Fe),ze=n.p+"static/media/cardIcon.2b436e10.png";function Pe(){var e=Object(d.a)(["\n  query QuestionnaireList($isReport: Boolean!) {\n    questionnaireList(isReport: $isReport) {\n      name\n      description\n      id\n      done\n      displayedFillInDate\n      userAnswerId\n      result\n      key\n    }\n  }\n"]);return Pe=function(){return e},e}var We=Object(c.gql)(Pe());function Ue(){var e=Object(d.a)(["\n  query QuestionnaireContent($id: String!) {\n    questionnaire(id: $id) {\n      instruction\n      name\n      questions {\n        choices\n        content\n      }\n      key\n    }\n    partialAnswer(questionnaireId: $id) {\n      answers\n    }\n  }\n"]);return Ue=function(){return e},e}var Me=Object(c.gql)(Ue());function Be(){var e=Object(d.a)(["\n  query Report($userAnswerIds: [String!]!) {\n    report(userAnswerIds: $userAnswerIds) {\n      pdf\n    }\n  }\n"]);return Be=function(){return e},e}var $e=Object(c.gql)(Be());function He(){var e=Object(d.a)(["\n  query ReportForAdmin($userId: String, $userAnswerIds: [String!]!) {\n    reportForAdmin(userId: $userId, userAnswerIds: $userAnswerIds) {\n      pdf\n    }\n  }\n"]);return He=function(){return e},e}var Qe=Object(c.gql)(He());function _e(){var e=Object(d.a)(["\n  query DoctorList($limit: Int!, $currentPageIndex: Int!) {\n    doctorList(limit: $limit, currentPageIndex: $currentPageIndex) {\n      total\n      admins {\n        name\n        userName\n      }\n    }\n  }\n"]);return _e=function(){return e},e}var Ve=Object(c.gql)(_e()),Je=n(404),Ke=n(405),Ge=function(e){var t=e.isOpen,n=e.handleClose,a=e.goToLogInPage,c=e.age,i=e.gender;return Object(r.jsxs)(je.a,{open:t,onClose:n,children:[Object(r.jsx)(be.a,{children:!c||c>=16&&!i?"\u8bf7\u60a8\u5b8c\u5584\u4fe1\u606f":c>=7&&c<16?"\u8bf7\u4f7f\u7528\u513f\u7ae5\u7248\u91cf\u8868":"\u5e74\u9f84\u4e0d\u7b26\u5408\u6761\u4ef6"}),Object(r.jsx)(Oe.a,{children:Object(r.jsxs)(Je.a,{children:[(!c||!i)&&"\u8bf7\u60a8\u586b\u5199\u6027\u522b\u548c\u5e74\u9f84\u4fe1\u606f\u3002",void 0!==c&&null!==c&&c<16?"\u586b\u5199\u8be5\u91cf\u8868\u6700\u5c0f\u5e74\u9f84\u4e3a16\u5c81\u3002":null]})}),Object(r.jsx)(Ke.a,{children:Object(r.jsx)(F.a,{onClick:!c||c>=16?a:n,color:"primary",autoFocus:!0,children:"\u786e\u5b9a"})})]})},Ye=function(e){var t=e.isOpen,n=e.handleClose,a=e.goToLogInPage,c=e.age,i=e.gender;return Object(r.jsxs)(je.a,{open:t,onClose:n,children:[Object(r.jsx)(be.a,{children:!c||c<16&&c>7&&!i?"\u8bf7\u60a8\u5b8c\u5584\u4fe1\u606f":c>=16?"\u8bf7\u4f7f\u7528\u6210\u4eba\u7248\u91cf\u8868":"\u5e74\u9f84\u4e0d\u7b26\u5408\u6761\u4ef6"}),Object(r.jsx)(Oe.a,{children:Object(r.jsxs)(Je.a,{children:[(!c||!i)&&"\u8bf7\u60a8\u586b\u5199\u6027\u522b\u548c\u5e74\u9f84\u4fe1\u606f\u3002",void 0!==c&&null!==c&&(c>=16||c<7)?"\u586b\u5199\u8be5\u91cf\u8868\u5e74\u9f84\u5e94\u57287\u5c81\u523015\u5c81\u4e4b\u95f4\u3002":null]})}),Object(r.jsx)(Ke.a,{children:Object(r.jsx)(F.a,{onClick:c&&(c>=16||c<7)?n:a,color:"primary",autoFocus:!0,children:"\u786e\u5b9a"})})]})},Xe=Object(R.a)((function(e){return Object(L.a)({content:{padding:"5px 10px"},listName:{fontSize:"1rem",color:"rgba(0, 0, 0, .654)",marginTop:20,marginBottom:20},root:{display:"grid",gridTemplateColumns:"repeat(auto-fill, ".concat(250,"px)"),rowGap:"20px",columnGap:"20px"},card:{height:212},cardActionArea:{width:250,cursor:"pointer","&:hover":{backgroundColor:Ee.a[50]},height:160,display:"flex",justifyContent:"flex-start",alignItems:"flex-start"},cardIcon:{width:40,height:40},unfinishedText:{fontSize:"0.8125rem",color:"rgba(0, 0, 0, .54)",margin:"5px 0"},finishedText:{fontSize:"0.8125rem",color:"#4caf50",margin:"5px 0"},questionnaireName:{fontSize:"1rem",color:"#111",lineHeight:"1.5rem"},cardActionContainer:{paddingLeft:20,height:50}})})),Ze=function(e){var t=e.patient,n=Object(Se.a)("(max-width:780px)"),s=Xe(),o=Object(c.useQuery)(We,{fetchPolicy:"no-cache",variables:{isReport:!1}}),l=o.loading,d=o.data,u=Object(i.useMemo)((function(){if(!d)return{uniqueFormList:[],resultList:[]};var e=[],t=[],n=new Set;return d.questionnaireList.forEach((function(a){if(n.has(a.id)){if(a.result&&a.displayedFillInDate)for(var r=0;r<=e.length;){if(e[r].id===a.id){t[r].push({result:a.result,fillInDate:a.displayedFillInDate});break}r+=1}}else n.add(a.id),e.push(a),a.result&&a.displayedFillInDate?t.push([{result:a.result,fillInDate:a.displayedFillInDate}]):t.push([])})),{uniqueFormList:e,resultList:t}}),[d]),j=u.uniqueFormList,b=u.resultList,O=Object(i.useState)(!1),h=Object(a.a)(O,2),m=h[0],f=h[1],p=Object(i.useState)(!1),x=Object(a.a)(p,2),g=x[0],v=x[1],C=function(){f(!1)},y=function(){v(!1)},w=function(){N.push("/user/login?userName=".concat(t.userName))},N=Object(k.g)();if(l)return Object(r.jsx)(U,{});if(d){var I=function(e){var t=Object(r.jsx)("span",{className:s.questionnaireName,children:e.name});if(/^.*\uff08.*\uff09$/.test(e.name)){var n=e.name.match(/^.*\uff08/),a=e.name.match(/\uff08.*\uff09/);if(n&&a){var c=n[0].substring(0,n[0].length-1),i=a[0];return Object(r.jsxs)("span",{className:s.questionnaireName,children:[c,Object(r.jsx)("br",{}),i.replace("\uff08","(").replace("\uff09",")")]})}return t}return t},S=function(e,n){if(n===fe){if(!t.gender||!t.age||t.age<16)return void f(!0)}else if(n===pe&&(!t.gender||!t.age||t.age>=16||t.age<=6))return void v(!0);N.push("/user/form?id=".concat(e))},T=function(e){return Object(r.jsx)("span",{className:e.done?s.finishedText:s.unfinishedText,children:e.done?"\u5df2\u5b8c\u6210":"\u672a\u5b8c\u6210"})};return n?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ke.a,{subheader:Object(r.jsx)(Te.a,{children:"\u91cf\u8868"}),children:j.map((function(e,t){return Object(r.jsxs)(Re.a,{button:!0,onClick:function(){return S(e.id,e.name)},children:[Object(r.jsx)(Le.a,{children:Object(r.jsx)("img",{src:ze,alt:"\u91cf\u8868\u56fe\u6807",className:s.cardIcon})}),Object(r.jsx)(Ae.a,{primary:Object(r.jsx)("div",{className:s.questionnaireName,children:e.name}),secondary:T(e)})]},e.id)}))}),Object(r.jsx)(Ge,{isOpen:m,handleClose:C,goToLogInPage:w,age:t.age,gender:t.gender}),Object(r.jsx)(Ye,{isOpen:g,handleClose:y,goToLogInPage:w,age:t.age,gender:t.gender})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:s.content,children:[Object(r.jsx)("p",{className:s.listName,children:"\u91cf\u8868"}),Object(r.jsx)("div",{className:s.root,children:j.map((function(e,t){return Object(r.jsxs)(A.a,{variant:"outlined",className:s.card,children:[Object(r.jsx)(qe.a,{className:s.cardActionArea,onClick:function(){return S(e.id,e.name)},children:Object(r.jsxs)(q.a,{children:[Object(r.jsx)("div",{children:Object(r.jsx)("img",{src:ze,alt:"\u91cf\u8868\u56fe\u6807",className:s.cardIcon})}),Object(r.jsx)("div",{children:I(e)}),T(e)]})}),Object(r.jsx)(_.a,{}),Object(r.jsx)(De.a,{className:s.cardActionContainer,children:Object(r.jsx)(Ce,{formResultList:b[t],formName:e.name,formKey:e.key})})]},e.id)}))})]}),Object(r.jsx)(Ge,{isOpen:m,handleClose:C,goToLogInPage:w,age:t.age,gender:t.gender}),Object(r.jsx)(Ye,{isOpen:g,handleClose:y,goToLogInPage:w,age:t.age,gender:t.gender})]})}return null},et=n(37),tt=n.n(et),nt=n(56),at=n(412),rt=n(413),ct=n(121),it=n.n(ct);function st(){var e=Object(d.a)(["\n  mutation PatientLogOut {\n    patientLogOut {\n      didRequest\n    }\n  }\n"]);return st=function(){return e},e}var ot,lt,dt=Object(c.gql)(st()),ut=Object(R.a)((function(e){return Object(L.a)({root:{flexGrow:1},header:{zIndex:e.zIndex.drawer+1},logo:{marginRight:e.spacing(2),maxWidth:30,maxHeight:30},title:{flexGrow:1,fontSize:"1.25rem"},timerHeader:{overflow:"hidden",backgroundColor:"rgb(236, 238, 248)"},actionContainer:{float:"right",paddingRight:20,paddingTop:10,fontSize:"0.875rem",display:"flex",alignItems:"center"}})})),jt=function(e){var t=e.viewer,n=e.setViewer,i=e.type,o=Object(k.g)(),l=s.a.useState(window.innerWidth),d=Object(a.a)(l,2),u=d[0],j=d[1],b=function(){window.innerWidth!==u&&j(window.innerWidth)};s.a.useEffect((function(){return window.addEventListener("resize",b),function(){return window.removeEventListener("resize",b)}}));var O=Object(c.useMutation)(x,{onCompleted:function(e){e&&e.doctorLogOut.didRequest&&(n(e.doctorLogOut),sessionStorage.removeItem("token"),console.log("log out successfully"))},onError:function(e){console.log(e),console.log("log out failed")}}),h=Object(a.a)(O,1)[0],m=Object(c.useMutation)(dt,{onCompleted:function(e){e&&e.patientLogOut&&(n(e.patientLogOut),console.log("log out successfully"))},onError:function(e){console.log(e),console.log("log out failed")}}),f=Object(a.a)(m,1)[0],p=function(){var e=Object(nt.a)(tt.a.mark((function e(){return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("doctor"!==i){e.next=6;break}return e.next=3,h();case 3:o.push("/doctor"),e.next=9;break;case 6:return e.next=8,f();case 8:o.push("/user");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=ut();return Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{path:"/user/form",exact:!0}),Object(r.jsx)(k.b,{path:"/",children:Object(r.jsx)("div",{className:g.root,children:Object(r.jsx)(at.a,{position:"fixed",className:g.header,children:Object(r.jsxs)(rt.a,{children:[Object(r.jsx)("img",{src:ye,alt:"\u4e2d\u5927\u533b\u9662",className:g.logo}),Object(r.jsx)("div",{className:g.title,children:window.innerWidth>=650?"\u4e1c\u5357\u5927\u5b66\u9644\u5c5e\u4e2d\u5927\u533b\u9662\u5fc3\u7406\u5065\u5eb7\u8bc4\u4f30\u7cfb\u7edf":"\u5fc3\u7406\u5065\u5eb7\u8bc4\u4f30\u7cfb\u7edf"}),Object(r.jsx)(k.d,{children:Object(r.jsx)(k.b,{path:["/doctor","/user"],children:t&&t.userName&&Object(r.jsx)(F.a,{color:"inherit",startIcon:Object(r.jsx)(it.a,{}),onClick:p,children:"doctor"===i?"\u9000\u51fa\u533b\u751f\u767b\u5f55":"\u9000\u51fa\u7cfb\u7edf"})})})]})})})})]})},bt=n(442),Ot=n(414),ht=n(443),mt=n(217),ft=n.n(mt),pt=n(122),xt=n.n(pt),gt=Object(R.a)((function(e){return Object(L.a)({propertyName:{color:"#5f6368",fontSize:"0.75rem",margin:"8px 0"},propertyDivider:{marginTop:5,marginBottom:5}})})),vt=["name","gender","age","education","jobStatus","marriageStatus"],Ct=["\u59d3\u540d","\u6027\u522b","\u5e74\u9f84","\u6559\u80b2","\u5de5\u4f5c","\u5a5a\u59fb"],yt=function(e){for(var t,n=gt(),a=e.viewer,c=[],i=0;i<vt.length;i++)void 0!==(t=a[vt[i]])&&null!==t&&""!==t&&c.push(i);return Object(r.jsx)(r.Fragment,{children:c.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:n.propertyName,children:Ct[e]}),Object(r.jsx)("div",{children:a[vt[e]]}),t!==c.length-1?Object(r.jsx)(_.a,{className:n.propertyDivider}):null]},"property-".concat(t))}))})},wt=n(214),Nt=n.n(wt),It=n(215),St=n.n(It),kt=n(216),Tt=n.n(kt),Rt=n(123),Lt=n.n(Rt),At=Object(R.a)((function(e){return Object(L.a)({drawer:{width:240,flexShrink:0,"@media (max-width:780px)":{display:"none"}},personalInfoCard:{margin:5,overflow:"auto"},personalInfoCardContent:{"&:last-child":{paddingBottom:16}},personalInfoText:{fontWeight:400,fontSize:"1.25rem",marginBottom:10},drawerPaper:{width:240},idChip:{marginTop:3,marginBottom:3},adminMenu:{padding:0},adminMenuHeader:{height:48,display:"flex",alignItems:"center",fontWeight:500,fontSize:"1.125rem",paddingLeft:10},link:{color:"#111"}})})),qt=function(e){var t=At(),n=Object(k.g)(),c=Object(k.h)(),i=e.viewer,o=e.type,l=s.a.useState(window.innerWidth),d=Object(a.a)(l,2),u=d[0],j=d[1],b=function(){window.innerWidth!==u&&j(window.innerWidth)};return s.a.useEffect((function(){return window.addEventListener("resize",b),function(){return window.removeEventListener("resize",b)}})),Object(r.jsxs)(bt.a,{className:t.drawer,variant:"permanent",classes:{paper:t.drawerPaper},style:{display:"doctor"===o&&window.innerWidth<=1150?"none":void 0},children:[Object(r.jsx)(rt.a,{}),"doctor"===o?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:t.adminMenuHeader,children:[i.name,"\u533b\u751f\u5df2\u767b\u5165"]}),Object(r.jsx)(_.a,{}),Object(r.jsxs)(ke.a,{className:t.adminMenu,children:[Object(r.jsxs)(Re.a,{button:!0,onClick:function(){n.push("/doctor/".concat(i.userName))},children:[Object(r.jsx)(Ot.a,{children:Object(r.jsx)(Nt.a,{color:c.pathname==="/doctor/".concat(i.userName)?"primary":"inherit"})}),Object(r.jsx)(Ae.a,{primary:"\u75c5\u4eba\u4fe1\u606f"})]},"patientInfo"),Object(r.jsx)(_.a,{}),Object(r.jsxs)(Re.a,{button:!0,onClick:function(){n.push("/doctor/".concat(i.userName,"/manage"))},children:[Object(r.jsx)(Ot.a,{children:Object(r.jsx)(St.a,{color:c.pathname==="/doctor/".concat(i.userName,"/manage")?"primary":"inherit"})}),Object(r.jsx)(Ae.a,{primary:"\u533b\u751f\u4fe1\u606f"})]},"doctorInfo"),Object(r.jsx)(_.a,{}),Object(r.jsx)("a",{href:"/user",className:t.link,target:"_blank",children:Object(r.jsxs)(Re.a,{button:!0,children:[Object(r.jsx)(Ot.a,{children:Object(r.jsx)(Tt.a,{})}),Object(r.jsx)(Ae.a,{primary:"\u60a3\u8005\u7aef"})]},"doctorInfo")}),Object(r.jsx)(_.a,{})]})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(A.a,{variant:"outlined",className:t.personalInfoCard,children:Object(r.jsxs)(q.a,{className:t.personalInfoCardContent,children:[Object(r.jsx)("div",{className:t.personalInfoText,children:"\u4e2a\u4eba\u4fe1\u606f"}),Object(r.jsx)("div",{className:t.idChip,children:Object(r.jsx)(ht.a,{size:"small",icon:Object(r.jsx)(xt.a,{}),color:"primary",label:"\u95e8\u8bca\u53f7\uff1a".concat(i.userName),variant:"outlined"})}),Object(r.jsx)(yt,{viewer:i})]})}),Object(r.jsxs)(ke.a,{children:[Object(r.jsxs)(Re.a,{button:!0,onClick:function(){n.push("/user/home")},children:[Object(r.jsx)(Ot.a,{children:Object(r.jsx)(ft.a,{color:"/user/home"===c.pathname?"primary":"inherit"})}),Object(r.jsx)(Ae.a,{primary:"\u91cf\u8868"})]},"form"),Object(r.jsxs)(Re.a,{button:!0,onClick:function(){n.push("/user/report")},children:[Object(r.jsx)(Ot.a,{children:Object(r.jsx)(Lt.a,{color:"/user/report"===c.pathname?"primary":"inherit"})}),Object(r.jsx)(Ae.a,{primary:"\u62a5\u544a"})]},"report")]})]})]})},Dt=n(416),Ft=n(401),Et=n(417),zt=n(433),Pt=n(418),Wt=100,Ut=Object(R.a)((function(e){return Object(L.a)({root:{width:Wt,backgroundColor:"rgba(0, 0, 0, 0.12)",display:"flex",marginRight:10,height:12,borderRadius:6},finished:{width:0,height:12,borderRadius:"6px 0 0 6px",backgroundColor:"#5eb8ff",maxWidth:94},leftCircle:{borderRadius:"6px 0 0 6px"},circle:{height:12,width:12,backgroundColor:"#5eb8ff"},circlewrapper:{overflow:"hidden"},rightCircle:{borderRadius:6,backgroundColor:"#5eb8ff"},rightCircleWrapper:{marginLeft:-6}})})),Mt=function(e){var t=e.totalNumber,n=e.currentIndex,a=Ut(),c=Wt*(n+1)/t;return Object(r.jsx)("div",{className:a.root,children:c>12?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:a.finished,style:{width:c}}),Wt-c<=6?Object(r.jsx)("div",{className:a.rightCircleWrapper+" "+a.circlewrapper,style:{width:12-(Wt-c)},children:Object(r.jsx)("div",{className:a.rightCircle+" "+a.circle})}):null]}):Object(r.jsx)("div",{className:a.circlewrapper,style:{width:c},children:Object(r.jsx)("div",{className:a.leftCircle+" "+a.circle})})})},Bt=n(415),$t=Object(R.a)((function(e){return Object(L.a)({root:{display:"flex",alignItems:"center"},timeNumber:{marginLeft:10,userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"}})})),Ht=function(){var e=$t(),t=Object(i.useState)(0),n=Object(a.a)(t,2),c=n[0],s=n[1];Object(i.useEffect)((function(){var e=setTimeout((function(){s(c+1)}),1e3);return function(){clearTimeout(e)}}),[c]);var o=Math.floor(c/3600),l=Math.floor(c/60),d=c%60;return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(Bt.a,{}),Object(r.jsx)("span",{className:e.timeNumber,children:"".concat(o<10?"0"+o:o,":").concat(l<10?"0"+l:l,":").concat(d<10?"0"+d:d)})]})},Qt=n(218),_t=n.n(Qt),Vt=n(68),Jt=n(58),Kt=Object(R.a)((function(e){return Object(L.a)({formContainer:{height:"100%",width:"100%",backgroundColor:"#e8f1fd"},form:{width:768,maxWidth:"90vw",margin:"auto",paddingTop:10},titleCard:{borderRadius:8,paddingBottom:5},titleCardColor:{height:10,borderTopLeftRadius:8,borderTopRightRadius:8,backgroundColor:er},titleCardContent:{paddingTop:5,marginLeft:5,marginRight:5},titleCardMainText:{fontSize:"2rem",fontWeight:400,marginTop:10,marginBottom:10},questionCard:{marginTop:10,borderRadius:8,marginBottom:10,paddingLeft:5,paddingRight:5},questionText:{fontSize:"1rem",fontWeight:400,marginBottom:16,marginTop:10,lineHeight:"1.4rem"},questionOptionText:{fontSize:"0.9rem",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},button:{backgroundColor:"#fff",color:er,"&:hover":{backgroundColor:"#fff"}},buttonWithRightMargin:{marginRight:10},finishedText:{fontSize:"0.875rem",marginTop:26,marginBottom:26},homeLink:{fontSize:"0.875rem"},exitButton:{position:"absolute",right:20,bottom:20,backgroundColor:"#fff","&:hover":{backgroundColor:"#fff"}},timerContaner:{position:"absolute",left:20,bottom:20},footer:{display:"flex",justifyContent:"space-between",alignItems:"center"},progressWrapper:{display:"flex",alignItems:"center",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},progressWrapperForSmallScreen:{marginTop:20}})})),Gt=function(){var e=Object(Se.a)("(max-width:780px)"),t=Kt(),n=new URLSearchParams(Object(k.h)().search).get("id"),s=Object(c.useQuery)(Me,{variables:{id:n||""},onCompleted:function(e){var t,n=e.partialAnswer;if(S(e.questionnaire.questions.map((function(e){return e.choices.map((function(e){return!1}))}))),null===n||void 0===n||null===(t=n.answers)||void 0===t?void 0:t.length){n.answers.length===e.questionnaire.questions.length&&Q(!0);var a={};n.answers.forEach((function(e,t){return a[t]=e})),E(a),y(Math.min(n.answers.length,e.questionnaire.questions.length-1))}},fetchPolicy:"no-cache"}),o=s.loading,l=s.data,d=Object(c.useMutation)(h,{onCompleted:function(e){e.saveUserAnswer.didRequest&&M(!0)}}),u=Object(a.a)(d,1)[0],j=Object(c.useMutation)(f),b=Object(a.a)(j,1)[0],O=Object(i.useRef)(u),m=Object(i.useRef)(b),p=Object(i.useRef)(null),x=Object(i.useRef)(null),g=Object(i.useState)(0),v=Object(a.a)(g,2),C=v[0],y=v[1],w=Object(i.useState)(),N=Object(a.a)(w,2),I=N[0],S=N[1],R=Object(i.useState)({}),L=Object(a.a)(R,2),D=L[0],E=L[1],z=Object(i.useState)(!1),P=Object(a.a)(z,2),W=P[0],M=P[1],B=Object(i.useState)(!1),$=Object(a.a)(B,2),H=$[0],Q=$[1],_=Object(i.useState)(!1),V=Object(a.a)(_,2),J=V[0],K=V[1],G=Object(i.useState)(!1),Y=Object(a.a)(G,2),X=Y[0],Z=Y[1],ee=Object(k.g)(),te=Object(i.useRef)(!1),ne=Object(i.useCallback)((function(){var e=null===l||void 0===l?void 0:l.questionnaire;if(!e)return[];for(var t=[],n=0;n<e.questions.length;n++)void 0!==D[n]&&t.push(D[n]);return t}),[D,null===l||void 0===l?void 0:l.questionnaire]),ae=Object(i.useCallback)((function(){var e=ne();return n&&0!==e.length?m.current({variables:{input:{questionnaireId:n,answers:e}}}):Promise.resolve()}),[ne,n]);if(Object(i.useEffect)((function(){return x.current=setInterval((function(){ae()}),1e4),function(){x.current&&(clearInterval(x.current),x.current=null)}}),[ae]),o)return Object(r.jsx)(U,{});if(!l)return Object(r.jsx)("div",{children:"Error"});var re=l.questionnaire,ce=function(){Z(!0)},ie=function(){y(C+1),p.current&&clearTimeout(p.current)},se=function(){ee.push("/user/home")},oe=function(){var e=Object(nt.a)(tt.a.mark((function e(){return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.current&&(clearTimeout(x.current),x.current=null),e.next=3,ae();case 3:se();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(e,t,n){if(!(te.current||I&&I[C][t])){var a=Object(T.a)({},D);if(a[C]=t,re.key===xe?function(e,t,n,a,r){if(0===r){var c=[1,2,3,4];if(0===a[r]){var i,s=Object(Jt.a)(c);try{for(s.s();!(i=s.n()).done;)a[i.value]=0}catch(L){s.e(L)}finally{s.f()}if(e(a),n){var o,l=n.map((function(e){return Object(Vt.a)(e)})),d=Object(Jt.a)(c);try{for(d.s();!(o=d.n()).done;)for(var u=o.value,j=0;j<l[u].length;j++)0!==j&&(l[u][j]=!0)}catch(L){d.e(L)}finally{d.f()}t(l)}}else if(e(a),n){var b,O=n.map((function(e){return Object(Vt.a)(e)})),h=Object(Jt.a)(c);try{for(h.s();!(b=h.n()).done;)for(var m=b.value,f=0;f<O[m].length;f++)0!==f&&(O[m][f]=!1)}catch(L){h.e(L)}finally{h.f()}t(O)}}else if(5===r){var p=[6,7,8,9];if(0===a[r]){var x,g=Object(Jt.a)(p);try{for(g.s();!(x=g.n()).done;)a[x.value]=0}catch(L){g.e(L)}finally{g.f()}if(e(a),n){var v,C=n.map((function(e){return Object(Vt.a)(e)})),y=Object(Jt.a)(p);try{for(y.s();!(v=y.n()).done;)for(var w=v.value,N=0;N<C[w].length;N++)0!==N&&(C[w][N]=!0)}catch(L){y.e(L)}finally{y.f()}t(C)}}else if(e(a),n){var I,S=n.map((function(e){return Object(Vt.a)(e)})),k=Object(Jt.a)(p);try{for(k.s();!(I=k.n()).done;)for(var T=I.value,R=0;R<S[T].length;R++)0!==R&&(S[T][R]=!1)}catch(L){k.e(L)}finally{k.f()}t(S)}}else e(a)}(E,S,I,a,C):E(a),C!==re.questions.length-1){K(!0),te.current=!0;var r=setTimeout((function(){re.key===xe?function(e,t,n,a){0===e&&0===n?t(5):5===e&&0===n?(t(9),a(!0)):t(e+1)}(C,y,t,Q):ie(),K(!1),te.current=!1}),190);p.current=r}else Q(!0)}},de=re.questions[C];return Object(r.jsxs)("div",{className:t.formContainer,children:[Object(r.jsxs)("div",{className:t.form,children:[Object(r.jsxs)(A.a,{className:t.titleCard,variant:"outlined",children:[Object(r.jsx)("div",{className:t.titleCardColor}),Object(r.jsxs)(q.a,{className:t.titleCardContent,children:[Object(r.jsx)("div",{className:t.titleCardMainText,children:re.name}),W&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:t.finishedText,children:"\u60a8\u5df2\u5b8c\u6210\u6b64\u91cf\u8868\u7684\u586b\u5199\u3002"}),Object(r.jsx)(Dt.a,{onClick:function(e){e.preventDefault(),se()},className:t.homeLink,href:"/",children:"\u56de\u5230\u4e3b\u9875"})]})]})]}),!W&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(A.a,{className:t.questionCard,variant:"outlined",children:Object(r.jsxs)(q.a,{children:[Object(r.jsx)("div",{className:t.questionText,children:"".concat(de.content)}),Object(r.jsx)(Ft.a,{component:"fieldset",children:de.choices.map((function(e,n){return Object(r.jsx)(Et.a,{value:e,control:Object(r.jsx)(zt.a,{color:"primary"}),label:Object(r.jsx)("span",{className:t.questionOptionText,children:e}),disabled:!(!I||!I[C][n])||void 0,checked:D[C]===n,onClick:function(e){return le(0,n)}},"choice-".concat(n))}))})]})}),Object(r.jsxs)("div",{className:e?"":t.footer,children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(F.a,{className:t.buttonWithRightMargin+" "+t.button,variant:"contained",onClick:function(){y(C-1),p.current&&clearTimeout(p.current)},disabled:0===C,children:"\u4e0a\u4e00\u9898"}),Object(r.jsx)(F.a,{className:t.buttonWithRightMargin+" "+t.button,variant:"contained",onClick:ie,disabled:!(C!==re.questions.length-1&&void 0!==D[C]&&!J||void 0!==D[C]&&void 0!==D[C+1]),children:"\u4e0b\u4e00\u9898"}),Object(r.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){if(x.current&&(clearTimeout(x.current),x.current=null),n){var e=ne();O.current({variables:{input:{questionnaireId:n,answers:e}}})}},disabled:!H,children:"\u63d0\u4ea4"})]}),Object(r.jsxs)("div",{className:t.progressWrapper+" "+(e?t.progressWrapperForSmallScreen:""),children:[Object(r.jsx)(Mt,{totalNumber:re.questions.length,currentIndex:C}),"\u7b2c ".concat(C+1," \u9898\uff08\u5171\n                 ").concat(re.questions.length," \u9898\uff09")]})]}),Object(r.jsx)("div",{className:t.timerContaner,children:Object(r.jsx)(Ht,{})}),Object(r.jsxs)(Pt.a,{className:t.exitButton,onClick:oe,variant:"extended",children:[Object(r.jsx)(_t.a,{color:"primary"}),"\u6682\u5b58\u5e76\u9000\u51fa"]})]})]}),Object(r.jsxs)(je.a,{open:!X&&!!re.instruction,onClose:ce,children:[Object(r.jsx)(be.a,{children:"\u6307\u5bfc\u8bed"}),Object(r.jsx)(Oe.a,{children:Object(r.jsx)(Je.a,{children:re.instruction})}),Object(r.jsx)(Ke.a,{children:Object(r.jsx)(F.a,{onClick:ce,color:"primary",autoFocus:!0,children:"\u7ee7\u7eed"})})]})]})},Yt=n(441),Xt=n(431),Zt=n(419),en=(Object(R.a)((function(e){return Object(L.a)({createAccountCard:{borderRadius:8,width:800,margin:"30px auto 0"},createAccountText:{fontSize:"1.5rem",textAlign:"left",marginBottom:10,marginTop:15,paddingLeft:40},promptText:{marginBottom:24,marginLeft:40,fontSize:"1rem"},inputContainer:{margin:"0 40px"},input:{width:"30%",paddingRight:10,marginBottom:10},buttonContainer:{marginTop:30,marginLeft:40,marginRight:40,marginBottom:30,display:"flex",justifyContent:"space-between"},formClassifyText:{color:"#5f6368",fontSize:"0.8em",marginBottom:5,marginTop:10}})})),n(420)),tn=n(421),nn=n(422),an=n(423),rn=n(424),cn=n(435),sn=n(425),on=n(426),ln=(ot=ae,function(e){var t=e.children,n=e.userAnswerIds,a=e.closeReport,i=Object(c.useQuery)($e,{variables:{userAnswerIds:n},fetchPolicy:"no-cache"}),s=i.data;return i.loading||!s?Object(r.jsx)(U,{}):s.report&&s.report.pdf?Object(r.jsx)(ot,{pdfData:s.report.pdf,closeReport:a,children:t}):null}),dn=Object(R.a)((function(e){return Object(L.a)({content:{padding:"5px 10px"},questionnaireTable:{marginTop:20,marginBottom:20},doneIcon:{color:"#4caf50"}})})),un=function(){var e=dn(),t=Object(c.useQuery)(We,{variables:{isReport:!0},fetchPolicy:"no-cache",onCompleted:function(e){var t,n=e.questionnaireList,a=0,r=Object(Jt.a)(n);try{for(r.s();!(t=r.n()).done;){t.value.done&&(a+=1)}}catch(l){r.e(l)}finally{r.f()}h(a);var c,i=new Set,s=Object(Jt.a)(n);try{for(s.s();!(c=s.n()).done;){var o=c.value;o.done&&o.userAnswerId&&i.add(o.userAnswerId)}}catch(l){s.e(l)}finally{s.f()}u(i)}}),n=t.loading,s=t.data,o=Object(i.useState)(new Set),l=Object(a.a)(o,2),d=l[0],u=l[1],j=Object(i.useState)(null),b=Object(a.a)(j,2),O=b[0],h=b[1],m=Object(i.useState)(!1),f=Object(a.a)(m,2),p=f[0],x=f[1];if(p)return Object(r.jsx)(ln,{userAnswerIds:Array.from(d),closeReport:function(){return x(!1)}});if(n||!s||null===O)return Object(r.jsx)(U,{});var g=s.questionnaireList;return Object(r.jsxs)("div",{className:e.content,children:[Object(r.jsx)(en.a,{component:V.a,className:e.questionnaireTable,children:Object(r.jsxs)(tn.a,{size:"small","aira-label":"\u9009\u62e9\u5df2\u5b8c\u6210\u7684\u91cf\u8868\uff0c\u751f\u6210\u62a5\u544a",children:[Object(r.jsx)(nn.a,{children:Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{padding:"checkbox",children:Object(r.jsx)(cn.a,{checked:d.size===O&&0!==d.size,disabled:0===O,onChange:function(e){var t=e.target.checked,n=new Set;if(t){var a,r=Object(Jt.a)(g);try{for(r.s();!(a=r.n()).done;){var c=a.value;c.done&&c.userAnswerId&&n.add(c.userAnswerId)}}catch(i){r.e(i)}finally{r.f()}}u(n)}})}),Object(r.jsx)(rn.a,{children:"\u91cf\u8868"}),Object(r.jsx)(rn.a,{children:"\u5b8c\u6210\u72b6\u6001"}),Object(r.jsx)(rn.a,{children:"\u5b8c\u6210\u65e5\u671f"})]})}),Object(r.jsx)(sn.a,{children:g.map((function(t,n){return Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{padding:"checkbox",children:Object(r.jsx)(cn.a,{disabled:!t.done,checked:!!t.userAnswerId&&d.has(t.userAnswerId),onChange:function(e){return t.userAnswerId&&function(e,t){var n=e.target.checked,a=new Set(d);n?a.add(t):a.delete(t),u(a)}(e,t.userAnswerId)}})}),Object(r.jsx)(rn.a,{children:t.name}),Object(r.jsx)(rn.a,{children:t.done?Object(r.jsx)(on.a,{className:e.doneIcon,fontSize:"small"}):null}),Object(r.jsx)(rn.a,{children:t.displayedFillInDate||null})]},"questionnaire-".concat(n))}))})]})}),Object(r.jsx)(F.a,{variant:"contained",color:"primary",disabled:0===d.size,onClick:function(){x(!0)},children:"\u751f\u6210\u62a5\u544a"})]})};function jn(){var e=Object(d.a)(["\n  query QueryUser(\n    $userName: String\n    $name: String\n    $gender: String\n    $ageRange: AgeRange\n    $minSignUpDate: SignUpDate\n    $maxSignUpDate: SignUpDate\n    $limit: Int!\n    $currentPageIndex: Int!\n    $filter: UsersFilter\n    $onlyMyPatient: Boolean\n    $additionalFields: [String!]\n  ) {\n    queryUser(\n      userName: $userName\n      name: $name\n      gender: $gender\n      ageRange: $ageRange\n      minSignUpDate: $minSignUpDate\n      maxSignUpDate: $maxSignUpDate\n      limit: $limit\n      currentPageIndex: $currentPageIndex\n      filter: $filter\n      onlyMyPatient: $onlyMyPatient\n      additionalFields: $additionalFields\n    ) {\n      total\n      users {\n        id\n        name\n        userName\n        gender\n        education\n        jobStatus\n        age\n        marriageStatus\n        signUpDate\n        doctorName\n        doctorUserName\n        doctorId\n        finishedForms {\n          name\n          id\n          displayedFillInDate\n          userAnswerId\n          result\n          doctorUserName\n          doctorName\n          doctorId\n          key\n        }\n        diagnosis\n      }\n    }\n  }\n"]);return jn=function(){return e},e}!function(e){e.DATE_LATEST="DATE_LATEST",e.DATE_OLDEST="DATE_OLDEST"}(lt||(lt={}));var bn=Object(c.gql)(jn()),On=n(219),hn=n(47),mn=n(430),fn=(n(345),n(238)),pn=n.n(fn),xn=n(242),gn=n.n(xn),vn=n(243),Cn=n.n(vn),yn=n(239),wn=n.n(yn),Nn=n(240),In=n.n(Nn),Sn=["depressed","anxious","biphasic","schizophrenia"],kn=["\u6291\u90c1\u969c\u788d","\u7126\u8651\u969c\u788d","\u53cc\u76f8\u969c\u788d","\u7cbe\u795e\u5206\u88c2\u75c7"],Tn=function(e,t){var n,a=[],r=Object(Jt.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;c!==t&&a.push(c)}}catch(i){r.e(i)}finally{r.f()}return a},Rn=function(e){var t=e.isDialogOpen,n=e.handleDialogClose,a=e.additionalFields,c=e.setAdditionalFields;return Object(r.jsxs)(je.a,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",children:[Object(r.jsx)(be.a,{id:"form-dialog-title",children:"\u9ad8\u7ea7\u7b5b\u9009"}),Object(r.jsx)(Oe.a,{children:kn.map((function(e,t){return Object(r.jsx)("div",{children:Object(r.jsx)(Et.a,{control:Object(r.jsx)(cn.a,{checked:a.includes(Sn[t]),onChange:function(e){var n;n=Sn[t],e.target.checked?a.includes(n)||c([].concat(Object(Vt.a)(a),[n])):c(Tn(a,n))}}),label:e})},e)}))})]})},Ln=n(241),An=n.n(Ln),qn="\u5e74\u9f84\u4e0d\u80fd\u4e3a\u8d1f\u6570\uff01",Dn=Object(R.a)((function(e){return Object(L.a)({promptText:{color:"#5f6368",fontSize:"0.8em",paddingBottom:5,paddingTop:5},input:{width:"30%",paddingRight:10,paddingBottom:5},rangeWrapper:{display:"inline-block"},ageRangeInput:{width:"40%"},dateRangeWrapper:{width:"60%"},ageRangeWrapper:{width:"30%",paddingRight:10},dateRangeInput:{width:"50%",paddingRight:10},ageInputIconWrapper:{width:"20%",display:"inline-flex",justifyContent:"center",paddingTop:20},buttonWrapper:{paddingTop:10},extraFieldsWrapper:{paddingTop:10},searchButton:{marginRight:10},whiteButton:{backgroundColor:"#fff",color:er,"&:hover":{backgroundColor:"#fff"}},rangeFormWrapper:{width:"100%",alignItems:"flex-start",display:"flex"},ageInputIcon:{width:16,height:16,color:"rgba(0, 0, 0, 0.54)"},chip:{marginRight:5},additionalFieldButton:{marginRight:5}})})),Fn={format:"yyyy/MM/dd",okLabel:"\u786e\u5b9a",cancelLabel:"\u53d6\u6d88",invalidLabel:"\u8f93\u5165\u7684\u65e5\u671f\u6709\u8bef\uff01",maxDateMessage:"\u8f93\u5165\u7684\u65e5\u671f\u592a\u5927\uff01",minDateMessage:"\u8f93\u5165\u7684\u65e5\u671f\u592a\u5c0f\uff01",invalidDateMessage:"\u8f93\u5165\u7684\u65e5\u671f\u6709\u8bef\uff01",size:"small"},En=Object(i.forwardRef)((function(e,t){var n=e.searchPatients,c=e.limit,s=(e.currentPageIndex,e.setCurrentPageIndex),o=e.filter,l=Dn(),d=Object(i.useState)(""),u=Object(a.a)(d,2),j=u[0],b=u[1],O=Object(i.useState)(""),h=Object(a.a)(O,2),m=h[0],f=h[1],p=Object(i.useState)(""),x=Object(a.a)(p,2),g=x[0],v=x[1],C=Object(i.useState)({min:"",max:""}),y=Object(a.a)(C,2),w=y[0],N=y[1],I=Object(i.useState)({min:null,max:null}),S=Object(a.a)(I,2),k=S[0],R=S[1],L=Object(i.useState)(!1),A=Object(a.a)(L,2),q=A[0],E=A[1],z=Object(i.useState)(!1),P=Object(a.a)(z,2),W=P[0],U=P[1],M=Object(i.useState)(""),B=Object(a.a)(M,2),H=B[0],Q=B[1],_=Object(i.useState)(null),V=Object(a.a)(_,2),J=V[0],K=V[1],G=Object(i.useState)(!1),Y=Object(a.a)(G,2),X=Y[0],Z=Y[1],ee=Object(i.useState)([]),te=Object(a.a)(ee,2),ne=te[0],ae=te[1],re=function(){return w.min&&Number(w.min)<0?(Q(qn),U(!0),void K("minAge")):w.max&&Number(w.max)<0?(Q(qn),U(!0),void K("maxAge")):w.min&&w.max&&Number(w.min)>Number(w.max)?(Q("\u6700\u5c0f\u5e74\u9f84\u5e94\u5c0f\u4e8e\u6700\u5927\u5e74\u9f84\uff01"),U(!0),void K("ageRange")):k.min&&k.max&&k.min>k.max?(Q("\u8d77\u59cb\u65e5\u671f\u5e94\u5728\u622a\u6b62\u65e5\u671f\u4e4b\u524d\uff01"),U(!0),void K("dateRange")):(s(0),void n({userName:j,name:m,gender:g,ageRange:{min:w.min?Number(w.min):null,max:w.max?Number(w.max):null},minSignUpDate:k.min?{year:k.min.getFullYear(),month:k.min.getMonth(),day:k.min.getDate()}:null,maxSignUpDate:k.max?{year:k.max.getFullYear(),month:k.max.getMonth(),day:k.max.getDate()}:null,limit:c,currentPageIndex:0,onlyMyPatient:q,filter:o,additionalFields:ne}))};Object(i.useImperativeHandle)(t,(function(){return{search:function(){re()}}}));return Object(r.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(r.jsx)("div",{className:l.promptText,children:"\u4e2a\u4eba\u4fe1\u606f"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(D.a,{label:"\u95e8\u8bca\u53f7",size:"small",className:l.input,value:j,onChange:function(e){b(e.target.value)}}),Object(r.jsx)(D.a,{label:"\u59d3\u540d",size:"small",className:l.input,value:m,onChange:function(e){f(e.target.value)}}),Object(r.jsxs)(Ft.a,{className:l.input,size:"small",children:[Object(r.jsx)(Yt.a,{children:"\u6027\u522b"}),Object(r.jsxs)(Xt.a,{color:"primary",label:"\u6027\u522b",value:g,onChange:function(e){v(e.target.value)},children:[Object(r.jsx)(Zt.a,{value:"\u7537",children:"\u7537"}),Object(r.jsx)(Zt.a,{value:"\u5973",children:"\u5973"}),Object(r.jsx)(Zt.a,{value:"\u5168\u90e8",children:"\u5168\u90e8"})]})]}),Object(r.jsxs)("div",{className:l.rangeFormWrapper,children:[Object(r.jsxs)("div",{className:l.ageRangeWrapper+" "+l.rangeWrapper,children:[Object(r.jsx)("div",{className:l.promptText,children:"\u5e74\u9f84"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(D.a,{label:"\u6700\u5c0f\u5e74\u9f84",size:"small",type:"number",className:l.ageRangeInput,value:w.min,onChange:function(e){var t=Number(e.target.value);"ageRange"===J&&(t<=Number(w.max)||0===t)&&K(null),"minAge"===J&&t>=0&&K(null),N(Object(T.a)(Object(T.a)({},w),{},{min:e.target.value}))},error:"ageRange"===J||"minAge"===J||void 0}),Object(r.jsx)("span",{className:l.ageInputIconWrapper,children:Object(r.jsx)(pn.a,{className:l.ageInputIcon})}),Object(r.jsx)(D.a,{label:"\u6700\u5927\u5e74\u9f84",size:"small",type:"number",className:l.ageRangeInput,value:w.max,onChange:function(e){var t=Number(e.target.value);"ageRange"===J&&(t>=Number(w.min)||0===t)&&K(null),"maxAge"===J&&t>=0&&K(null),N(Object(T.a)(Object(T.a)({},w),{},{max:e.target.value}))},error:"ageRange"===J||"maxAge"===J||void 0})]})]}),Object(r.jsxs)("div",{className:l.dateRangeWrapper+" "+l.rangeWrapper,children:[Object(r.jsx)("div",{className:l.promptText,children:"\u6ce8\u518c\u65f6\u95f4"}),Object(r.jsxs)(hn.a,{utils:On.a,locale:wn.a,children:[Object(r.jsx)(mn.a,Object(T.a)(Object(T.a)({value:k.min,onChange:function(e,t){"dateRange"===J&&(null===e||k.max&&+e<=+k.max)&&K(null),R(Object(T.a)(Object(T.a)({},k),{},{min:e}))},label:"\u8d77\u59cb\u65e5\u671f",className:l.dateRangeInput},Fn),{},{error:"dateRange"===J||void 0})),Object(r.jsx)(mn.a,Object(T.a)(Object(T.a)({value:k.max,onChange:function(e,t){"dateRange"===J&&(null===e||k.min&&+e>=+k.min)&&K(null),R(Object(T.a)(Object(T.a)({},k),{},{max:e}))},label:"\u622a\u6b62\u65e5\u671f",className:l.dateRangeInput},Fn),{},{error:"dateRange"===J||void 0}))]})]})]})]}),Object(r.jsxs)("div",{className:l.extraFieldsWrapper,children:[Object(r.jsx)(Et.a,{control:Object(r.jsx)(cn.a,{checked:q,onChange:function(e){E(e.target.checked)}}),label:"\u53ea\u9009\u62e9\u6211\u7684\u75c5\u4eba"}),Object(r.jsx)(F.a,{startIcon:Object(r.jsx)(In.a,{}),onClick:function(){Z(!0)},color:"primary",className:l.additionalFieldButton,children:"\u9ad8\u7ea7\u7b5b\u9009"}),Sn.map((function(e,t){if(ne.includes(e)){return Object(r.jsx)(ht.a,{variant:"outlined",size:"small",onDelete:function(){ae(Tn(ne,e))},icon:Object(r.jsx)(An.a,{}),color:"primary",label:kn[t],className:t!==ne.length-1?l.chip:""},e)}return null}))]}),Object(r.jsxs)("div",{className:l.buttonWrapper,children:[Object(r.jsx)(F.a,{variant:"contained",color:"primary",startIcon:Object(r.jsx)(gn.a,{}),className:l.searchButton,onClick:re,children:"\u641c\u7d22"}),Object(r.jsx)(F.a,{variant:"contained",startIcon:Object(r.jsx)(Cn.a,{}),className:l.whiteButton,onClick:function(){b(""),f(""),v(""),N({min:"",max:""}),R({min:null,max:null}),K(null),s(0),E(na),n({limit:c,currentPageIndex:0,filter:o,onlyMyPatient:na}),ae([])},children:"\u91cd\u7f6e"})]}),Object(r.jsx)($,{showError:W,setShowError:U,errorMessage:H}),Object(r.jsx)(Rn,{isDialogOpen:X,handleDialogClose:function(){Z(!1)},additionalFields:ne,setAdditionalFields:ae})]})})),zn=Object(R.a)((function(e){return Object(L.a)({root:{height:48,display:"flex",alignItems:"center",paddingLeft:10,fontWeight:500,fontSize:"1.125rem"}})})),Pn=function(e){var t=e.text,n=zn();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:n.root,children:t}),Object(r.jsx)(_.a,{})]})},Wn=n(436),Un=n(444),Mn=function(e){var t=e.finishedForms,n=null===t||0===t.length,c=Object(i.useMemo)((function(){if(!t)return{uniqueFormList:[],resultList:[]};var e=[],n=[],a=new Set;t.forEach((function(t){if(a.has(t.id)){if(t.result&&t.displayedFillInDate)for(var r=0;r<=e.length;){if(e[r].id===t.id){n[r].push({result:t.result,fillInDate:t.displayedFillInDate});break}r+=1}}else a.add(t.id),e.push(t),t.result&&t.displayedFillInDate?n.push([{result:t.result,fillInDate:t.displayedFillInDate}]):n.push([])}));var r=n.map((function(e){return Object(Vt.a)(e).reverse()}));return{uniqueFormList:e,resultList:r}}),[t]),s=c.uniqueFormList,o=c.resultList,l=Object(i.useState)(!1),d=Object(a.a)(l,2),u=d[0],j=d[1],b=function(){j(!1)};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(F.a,{startIcon:Object(r.jsx)(me.a,{}),color:"primary",disabled:n,onClick:function(){j(!0)},size:"small",children:"\u8d8b\u52bf"}),Object(r.jsxs)(je.a,{open:u,onClose:b,children:[Object(r.jsx)(be.a,{children:"\u67e5\u770b\u8d8b\u52bf"}),Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(en.a,{children:Object(r.jsxs)(tn.a,{size:"small",children:[Object(r.jsx)(nn.a,{children:Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{children:"\u91cf\u8868"}),Object(r.jsx)(rn.a,{})]})}),Object(r.jsx)(sn.a,{children:s.map((function(e,t){return Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{children:e.name}),Object(r.jsx)(rn.a,{children:Object(r.jsx)(Ce,{formResultList:o[t],formName:e.name,formKey:e.key})})]},"questionnaire-".concat(t))}))})]})}),Object(r.jsx)(Ke.a,{children:Object(r.jsx)(F.a,{onClick:b,color:"primary",children:"\u5173\u95ed"})})]})]})]})},Bn=n(244),$n=n.n(Bn),Hn=Object(R.a)((function(e){return Object(L.a)({diagnosisText:{minWidth:250}})})),Qn=function(e){var t=e.isDialogOpen,n=e.handleDialogClose,s=e.patientName,o=e.patientId,l=e.refetch,d=Object(c.useMutation)(y),u=Object(a.a)(d,1)[0];Object(i.useEffect)((function(){m("")}),[s]);var j=Hn(),b=Object(i.useState)(""),O=Object(a.a)(b,2),h=O[0],m=O[1],f=function(){var e=Object(nt.a)(tt.a.mark((function e(){return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===h){e.next=5;break}return e.next=3,u({variables:{input:{patientId:o,diagnosis:Sn[kn.indexOf(h)]}}});case 3:e.next=7;break;case 5:return e.next=7,u({variables:{input:{patientId:o,diagnosis:h}}});case 7:n(),l();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(je.a,{open:t,onClose:n,children:[Object(r.jsx)(be.a,{children:"\u8bca\u65ad"}),Object(r.jsxs)(Oe.a,{children:[Object(r.jsxs)(Je.a,{className:j.diagnosisText,children:["\u7ed9",s,"\u6dfb\u52a0\u8bca\u65ad"]}),Object(r.jsxs)(Ft.a,{fullWidth:!0,children:[Object(r.jsx)(Yt.a,{shrink:!0,children:"\u8bca\u65ad"}),Object(r.jsx)(Xt.a,{value:h,onChange:function(e){m(e.target.value)},children:kn.map((function(e){return Object(r.jsx)(Zt.a,{value:e,children:e},e)}))})]})]}),Object(r.jsxs)(Ke.a,{children:[Object(r.jsx)(F.a,{onClick:n,children:"\u53d6\u6d88"}),Object(r.jsx)(F.a,{onClick:f,color:"primary",children:"\u786e\u8ba4"})]})]})},_n=Object(R.a)((function(e){return Object(L.a)({root:{marginTop:20,width:"calc(100% - 20px)",minWidth:1085,fontSize:"0.9rem"},loadingIndicatorWrapper:{width:"100%",height:200},reportButton:{backgroundColor:"#fff",color:er,"&:hover":{backgroundColor:"#fff"}},lineChartsButtonContainer:{marginRight:5},tableCell:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},iconMargin:{marginRight:5}})})),Vn=["\u95e8\u8bca\u53f7","\u59d3\u540d","\u6027\u522b","\u5e74\u9f84","\u6559\u80b2","\u804c\u4e1a","\u5a5a\u59fb","\u6ce8\u518c\u65f6\u95f4","\u533b\u751f","\u8bca\u65ad"],Jn=["userName","name","gender","age","education","jobStatus","marriageStatus","signUpDate","doctorName","diagnosis"],Kn=[70,80,60,60,90,70,60,150,80,140],Gn=[140,80,60,60,90,70,60,150,80,140],Yn=function(e){var t=_n(),n=e.loading,c=e.patientList,s=e.selectedUserAnswerIds,o=e.setSelectedUserId,l=e.setSelectedUserAnswerIds,d=e.setIsReportShown,u=e.limit,j=e.currentPageIndex,b=e.handleLimitChange,O=e.handleCurrentPageIndexChange,h=e.filter,m=e.handleSortChange,f=e.refetch,p=Object(i.useState)(!1),x=Object(a.a)(p,2),g=x[0],v=x[1],C=Object(i.useState)(!1),y=Object(a.a)(C,2),w=y[0],N=y[1],I=Object(i.useState)(null),S=Object(a.a)(I,2),k=S[0],T=S[1],R=Object(i.useState)(!1),L=Object(a.a)(R,2),A=L[0],q=L[1],D=Object(i.useState)(null),E=Object(a.a)(D,2),z=E[0],P=E[1],W=Object(i.useState)(null),M=Object(a.a)(W,2),B=M[0],H=M[1],_=function(e,t){H(e),P(t),q(!0)};if(Object(i.useEffect)((function(){!1===n&&void 0!==c&&0===c.queryUser.users.length&&v(!0)}),[n,c]),n)return Object(r.jsx)("div",{className:t.loadingIndicatorWrapper,children:Object(r.jsx)(U,{})});if(void 0===c)return null;if(0===c.queryUser.users.length)return Object(r.jsx)($,{showError:g,setShowError:v,errorMessage:"\u672a\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u75c5\u4eba\uff01"});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(en.a,{component:V.a,className:t.root,children:[Object(r.jsx)(Wn.a,{rowsPerPage:u,rowsPerPageOptions:[5,10,25],page:j,count:c.queryUser.total,onChangePage:function(e,t){O(t)},component:"div",onChangeRowsPerPage:function(e){b(Number(e.target.value))},labelDisplayedRows:function(e){var t=e.from,n=(e.to,e.count);return"\u5171\u8ba1".concat(n,"\u6761\u6570\u636e\uff0c\u5f53\u524d\u4e3a\u7b2c").concat(Math.ceil(t/u),"\u9875")}}),Object(r.jsxs)(tn.a,{size:"small","aria-label":"\u75c5\u4eba\u5217\u8868",children:[Object(r.jsx)(nn.a,{children:Object(r.jsxs)(an.a,{children:[Vn.map((function(e,n){return Object(r.jsx)(rn.a,{style:{minWidth:Kn[n],maxWidth:Gn[n],padding:5,paddingLeft:0===n?10:void 0},className:t.tableCell,children:"signUpDate"===Jn[n]?Object(r.jsx)(Un.a,{active:"signUpDate"===Jn[n],direction:h===lt.DATE_LATEST?"desc":"asc",onClick:m,children:e}):e},e)})),Object(r.jsx)(rn.a,{style:{padding:5}})]})}),Object(r.jsx)(sn.a,{children:c.queryUser.users.map((function(e){var n=!e.finishedForms||0===e.finishedForms.length;return Object(r.jsxs)(an.a,{children:[Jn.map((function(n,a){var c=a===Jn.length-1?kn[Sn.indexOf(e[n])]:e[n];return Object(r.jsx)(rn.a,{style:{minWidth:Kn[a],maxWidth:Gn[a],padding:5,paddingLeft:0===a?10:void 0},className:t.tableCell,title:c||void 0,children:a===Jn.length-1?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Q.a,{"aria-label":"delete",className:t.iconMargin,size:"small",color:"primary",onClick:function(){return e.name&&_(e.name,e.id)},children:Object(r.jsx)($n.a,{fontSize:"inherit"})}),c]}):c},n)})),Object(r.jsx)(rn.a,{style:{minWidth:180,padding:0},children:Object(r.jsxs)("div",{style:{display:"flex"},children:[Object(r.jsx)("span",{className:t.lineChartsButtonContainer,children:Object(r.jsx)(Mn,{finishedForms:e.finishedForms})}),Object(r.jsx)(F.a,{size:"small",className:t.reportButton,color:"primary",startIcon:Object(r.jsx)(Lt.a,{}),disabled:n,onClick:function(){return e.finishedForms&&function(e,t){o(t),T(e);var n=e.map((function(e){return e.userAnswerId})).filter((function(e){return null!==e}));l(n),N(!0)}(e.finishedForms,e.id)},children:"\u62a5\u544a"})]})})]},e.userName)}))})]})]}),k&&s&&Object(r.jsx)(Zn,{isOpen:w,closeModal:function(){N(!1)},finishedFormList:k,selectedUserAnswerIds:s,setSelectedUserAnswerIds:l,onOkButtonClick:function(){d(!0)}}),B&&z&&Object(r.jsx)(Qn,{isDialogOpen:A,handleDialogClose:function(){q(!1)},patientName:B,patientId:z,refetch:f})]})},Xn=(n(402),n(245),Object(R.a)((function(e){return Object(L.a)({popover:{pointerEvents:"none"},paper:{padding:e.spacing(1)},icon:{width:22,height:22}})})),Object(R.a)((function(e){return Object(L.a)({formName:{maxWidth:300,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})}))),Zn=function(e){var t=e.isOpen,n=e.closeModal,a=e.finishedFormList,c=e.selectedUserAnswerIds,i=e.setSelectedUserAnswerIds,s=e.onOkButtonClick,o=Xn();return Object(r.jsxs)(je.a,{open:t,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"md",children:[Object(r.jsx)(be.a,{id:"alert-dialog-title",children:"\u8bf7\u9009\u62e9\u8981\u751f\u6210\u62a5\u544a\u7684\u91cf\u8868"}),Object(r.jsx)(Oe.a,{children:Object(r.jsx)(en.a,{children:Object(r.jsxs)(tn.a,{size:"small","aira-label":"\u9009\u62e9\u91cf\u8868\uff0c\u751f\u6210\u62a5\u544a",children:[Object(r.jsx)(nn.a,{children:Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{padding:"checkbox",children:Object(r.jsx)(cn.a,{checked:c.length===a.length&&0!==c.length,onChange:function(){c.length<a.length?i(a.map((function(e){return e.userAnswerId})).filter((function(e){return null!==e}))):i([])}})}),Object(r.jsx)(rn.a,{children:"\u5168\u90e8\u5df2\u5b8c\u6210\u91cf\u8868"}),Object(r.jsx)(rn.a,{children:"\u5b8c\u6210\u65f6\u95f4"}),Object(r.jsx)(rn.a,{children:"\u533b\u751f"})]})}),Object(r.jsx)(sn.a,{children:a.map((function(e,t){return Object(r.jsxs)(an.a,{children:[Object(r.jsx)(rn.a,{padding:"checkbox",children:Object(r.jsx)(cn.a,{checked:!!e.userAnswerId&&-1!==c.indexOf(e.userAnswerId),onChange:function(){return e.userAnswerId&&(t=e.userAnswerId,void(-1!==c.indexOf(t)?i(c.filter((function(e){return e!==t}))):i([].concat(Object(Vt.a)(c),[t]))));var t}})}),Object(r.jsx)(rn.a,{className:o.formName,children:e.name}),Object(r.jsx)(rn.a,{children:e.displayedFillInDate||null}),Object(r.jsx)(rn.a,{children:e.doctorName||null})]},"questionnaire-".concat(t))}))})]})})}),Object(r.jsxs)(Ke.a,{children:[Object(r.jsx)(F.a,{onClick:n,children:"\u53d6\u6d88"}),Object(r.jsx)(F.a,{onClick:function(){s(),n()},color:"primary",autoFocus:!0,disabled:0===c.length,children:"\u786e\u5b9a"})]})]})},ea=Object(R.a)((function(e){return Object(L.a)({content:{padding:"5px 10px"}})})),ta=function(e){return function(t){var n=t.children,a=t.userAnswerIds,i=t.closeReport,s=t.userId,o=Object(c.useQuery)(Qe,{variables:{userAnswerIds:a,userId:s},fetchPolicy:"no-cache"}),l=o.data;return o.loading||!l?Object(r.jsx)(U,{}):l.reportForAdmin&&l.reportForAdmin.pdf?Object(r.jsx)(e,{pdfData:l.reportForAdmin.pdf,closeReport:i,children:n}):null}}(ae),na=!1,aa=function(){var e=Object(c.useLazyQuery)(bn,{fetchPolicy:"no-cache"}),t=Object(a.a)(e,2),n=t[0],s=t[1],o=s.loading,l=s.data,d=Object(i.useRef)(null),u=Object(i.useState)(10),j=Object(a.a)(u,2),b=j[0],O=j[1],h=Object(i.useState)(0),m=Object(a.a)(h,2),f=m[0],p=m[1],x=Object(i.useState)(lt.DATE_LATEST),g=Object(a.a)(x,2),v=g[0],C=g[1],y=ea(),w=Object(i.useState)(null),N=Object(a.a)(w,2),I=N[0],S=N[1],k=Object(i.useState)(null),R=Object(a.a)(k,2),L=R[0],A=R[1],q=Object(i.useState)(!1),D=Object(a.a)(q,2),F=D[0],E=D[1],z=Object(i.useRef)(n),P=Object(i.useState)({limit:10,currentPageIndex:0}),W=Object(a.a)(P,2),U=W[0],M=W[1];return Object(i.useEffect)((function(){z.current({variables:{limit:10,currentPageIndex:0,filter:lt.DATE_LATEST,onlyMyPatient:na}})}),[]),F&&L&&I?Object(r.jsx)(ta,{userId:L,userAnswerIds:I,closeReport:function(){E(!1)}}):Object(r.jsxs)("div",{children:[Object(r.jsx)(Pn,{text:"\u641c\u7d22\u75c5\u4eba\u4fe1\u606f"}),Object(r.jsxs)("div",{className:y.content,children:[Object(r.jsx)(En,{searchPatients:function(e){n({variables:e}),M(e)},limit:b,currentPageIndex:f,ref:d,setCurrentPageIndex:p,filter:v}),Object(r.jsx)(Yn,{loading:o,patientList:l,selectedUserAnswerIds:I,setSelectedUserId:A,setSelectedUserAnswerIds:S,setIsReportShown:E,limit:b,currentPageIndex:f,handleLimitChange:function(e){O(e),p(0),n({variables:Object(T.a)(Object(T.a)({},U),{},{limit:e,currentPageIndex:0,filter:v})})},handleCurrentPageIndexChange:function(e){p(e),n({variables:Object(T.a)(Object(T.a)({},U),{},{limit:b,currentPageIndex:e,filter:v})})},filter:v,setFilter:C,handleSortChange:function(){var e=v===lt.DATE_LATEST?lt.DATE_OLDEST:lt.DATE_LATEST;C(e),p(0),n({variables:Object(T.a)(Object(T.a)({},U),{},{limit:b,currentPageIndex:0,filter:e})})},refetch:function(){n({variables:Object(T.a)(Object(T.a)({},U),{},{limit:b,currentPageIndex:f,filter:v})})}})]})]})},ra=(Object(R.a)((function(e){return Object(L.a)({root:{overflow:"hidden"},actionContainer:{float:"right",paddingRight:10,paddingTop:10,fontSize:"0.875rem",display:"flex",alignItems:"center"},welcomeMessage:{paddingRight:10,paddingBottom:1}})})),n(428)),ca=n(246),ia=n.n(ca),sa=Object(R.a)((function(e){return Object(L.a)({passwordInput:{minWidth:300}})})),oa=Object(i.forwardRef)((function(e,t){var n=function(e){"Enter"===e.key&&g()};Object(i.useEffect)((function(){return window.addEventListener("keydown",n),function(){window.removeEventListener("keydown",n)}}));var c=sa(),s=e.isDialogOpen,o=e.setIsDialogOpen,l=e.doctorName,d=e.handleDoctorLogIn,u=e.hideErrorIndicator,j=Object(i.useState)(""),b=Object(a.a)(j,2),O=b[0],h=b[1],m=Object(i.useState)(!1),f=Object(a.a)(m,2),p=f[0],x=f[1];Object(i.useImperativeHandle)(t,(function(){return{showError:function(){x(!0)},hideError:function(){x(!1)}}}));var g=function(){d(O)},v=function(){o(!1)};return Object(r.jsxs)(je.a,{open:s,onClose:v,children:[Object(r.jsx)(be.a,{children:"\u8bf7\u786e\u8ba4\u60a8\u7684\u5bc6\u7801"}),Object(r.jsxs)(Oe.a,{children:[Object(r.jsxs)(Je.a,{children:["\u5f53\u524d\u767b\u5165\u7684\u533b\u751f\u4e3a",l]}),Object(r.jsxs)(ra.a,{container:!0,spacing:2,alignItems:"center",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(ia.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(D.a,{autoFocus:!0,className:c.passwordInput,label:"\u5bc6\u7801",type:"password",value:O,onChange:function(e){u(),h(e.target.value)},helperText:p&&!O?"\u8bf7\u8f93\u5165\u60a8\u7684\u5bc6\u7801":void 0,error:!(!p||O)||void 0})})]})]}),Object(r.jsxs)(Ke.a,{children:[Object(r.jsx)(F.a,{onClick:v,color:"primary",children:"\u53d6\u6d88"}),Object(r.jsx)(F.a,{onClick:g,color:"primary",children:"\u786e\u8ba4"})]})]})})),la=n(247),da=n.n(la),ua=Object(R.a)((function(e){return Object(L.a)({root:{height:"100%",width:"100%",background:"#e3f2fd"},logoContainer:{display:"flex",minHeight:92,maxHeight:290,height:"calc(100% - 560px)",justifyContent:"center"},logo:{maxHeight:92,height:"100%",marginTop:"auto"},actionContainer:{maxHeight:160,padding:20,display:"flex",alignItems:"center",flexDirection:"column",fontSize:"1.5rem"},enterSystemButtonContainer:{marginTop:18},extendedIcon:{position:"absolute",right:20,bottom:20,backgroundColor:"#fff"},seuText:{margin:"10px 0 15px"},header:{height:52}})})),ja=function(e){e.setDoctor;var t=e.doctor,n=e.logIn,c=Object(k.g)(),s=ua(),o=Object(i.useRef)(null),l=Object(i.useState)(!1),d=Object(a.a)(l,2),u=d[0],j=d[1],b=Object(i.useState)(!1),O=Object(a.a)(b,2),h=O[0],m=O[1],f=function(){var e=Object(nt.a)(tt.a.mark((function e(a){var r,i;return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.userName){e.next=14;break}if(a){e.next=4;break}return null===(r=o.current)||void 0===r||r.showError(),e.abrupt("return");case 4:return e.prev=4,e.next=7,n({variables:{input:{userName:t.userName,password:a}}});case 7:(i=e.sent).data&&i.data.doctorLogIn.userName&&(console.log("Second login succeeds."),c.push("/doctor")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),m(!0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:s.root,children:[Object(r.jsx)("div",{className:s.header}),Object(r.jsx)("div",{className:s.logoContainer,children:Object(r.jsx)("img",{src:ye,alt:"\u4e2d\u5927\u533b\u9662",className:s.logo})}),Object(r.jsxs)("div",{className:s.actionContainer,children:[Object(r.jsx)("div",{className:s.seuText,children:"\u4e1c\u5357\u5927\u5b66\u9644\u5c5e\u4e2d\u5927\u533b\u9662"}),Object(r.jsx)("div",{children:"\u5fc3\u7406\u5065\u5eb7\u8bc4\u4f30\u7cfb\u7edf"}),Object(r.jsx)("div",{className:s.enterSystemButtonContainer,children:Object(r.jsx)(F.a,{startIcon:Object(r.jsx)(da.a,{}),color:"primary",variant:"contained",onClick:function(){c.push("/user/prompt")},children:"\u8fdb\u5165\u7cfb\u7edf"})})]}),t.name&&Object(r.jsx)(oa,{isDialogOpen:u,setIsDialogOpen:j,doctorName:t.name,handleDoctorLogIn:f,hideErrorIndicator:function(){m(!1)},ref:o}),Object(r.jsx)($,{showError:h,setShowError:m,errorMessage:"\u5bc6\u7801\u4e0d\u6b63\u786e\uff01"})]})},ba=n(128),Oa=n.n(ba),ha=Object(R.a)((function(e){return Object(L.a)({root:{background:"#e3f2fd",height:"100%",width:"100%"},titleWrapper:{height:"100%"},title:{fontSize:"1.5rem",textAlign:"center"},promptTextContainer:{display:"flex",justifyContent:"center",paddingTop:50,background:"#e3f2fd"},promptText:{width:"50%",minWidth:"min(85%, 400px)",lineHeight:"1.5rem"},buttonContainer:{display:"flex",justifyContent:"center",paddingTop:50,background:"#e3f2fd",paddingBottom:20},titleContainer:{minHeight:75,maxHeight:290,height:"calc(100% - 610px)",display:"flex",flexDirection:"column",justifyContent:"flex-end",background:"#e3f2fd"}})})),ma=function(){var e=ha();return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(se,{}),Object(r.jsx)("div",{className:e.titleContainer,children:Object(r.jsx)("div",{className:e.title,children:"\u6307\u5bfc\u8bed"})}),Object(r.jsx)("div",{className:e.promptTextContainer,children:Object(r.jsx)("div",{className:e.promptText,children:"\u5728\u63a5\u4e0b\u6765\u5927\u7ea620\u5206\u949f\u7684\u65f6\u95f4\u91cc\u60a8\u5c06\u8fdb\u884c\u4e00\u7cfb\u5217\u7684\u91cf\u8868\u8bc4\u4f30\uff0c\u76ee\u7684\u662f\u5bf9\u60a8\u7684\u5fc3\u7406\u72b6\u51b5\u53ca\u4e2a\u6027\u7279\u5f81\u8fdb\u884c\u8bc4\u4f30\uff0c\u4e0b\u9762\u7684\u95ee\u9898\u5e76\u4e0d\u5b58\u5728\u6240\u8c13\u6b63\u786e\u6216\u8005\u9519\u8bef\u7684\u7b54\u6848\uff0c\u60a8\u53ea\u9700\u8981\u6309\u7167\u81ea\u5df1\u771f\u5b9e\u7684\u72b6\u51b5\u5b8c\u6210\u5c31\u53ef\u4ee5\u4e86\u3002\u4e5f\u8bb8\u60a8\u4f1a\u89c9\u5f97\u81ea\u5df1\u5e76\u4e0d\u5b8c\u5168\u5982\u9898\u76ee\u6240\u63cf\u8ff0\u7684\u90a3\u6837\uff0c\u8fd9\u65f6\u5019\u60a8\u53ef\u4ee5\u6839\u636e\u9009\u9879\u9009\u62e9\u6700\u63a5\u8fd1\u60a8\u7684\u72b6\u51b5\u3002\u8bf7\u8bb0\u4f4f\uff0c\u8fd9\u91cc\u5e76\u6ca1\u6709\u6b63\u786e\u6216\u9519\u8bef\uff0c\u60a8\u53ea\u8981\u5982\u5b9e\u56de\u7b54\u95ee\u9898\u5c31\u53ef\u4ee5\u4e86\u3002"})}),Object(r.jsx)("div",{className:e.buttonContainer,children:Object(r.jsx)(S.b,{to:"/user/login",children:Object(r.jsx)(F.a,{variant:"contained",color:"primary",endIcon:Object(r.jsx)(Oa.a,{}),children:"\u4e0b\u4e00\u6b65"})})})]})},fa=n(248),pa=n.n(fa),xa=n(427),ga=n(249),va=n.n(ga),Ca=n(250),ya=n.n(Ca),wa=n(251),Na=n.n(wa),Ia=n(252),Sa=n.n(Ia),ka=n(253),Ta=n.n(ka);function Ra(){var e=Object(d.a)(["\n  mutation PatientLogIn($input: UserLoginInput) {\n    patientLogIn(input: $input) {\n      name\n      userName\n      education\n      jobStatus\n      gender\n      marriageStatus\n      age\n      didRequest\n    }\n  }\n"]);return Ra=function(){return e},e}var La=Object(c.gql)(Ra()),Aa=Object(R.a)((function(e){return Object(L.a)({root:{background:"#e3f2fd",height:"100%",width:"100%"},titleWrapper:{height:"100%"},title:{fontSize:"1.5rem",textAlign:"center"},buttonContainer:{display:"flex",justifyContent:"center",paddingTop:50,background:"#e3f2fd",paddingBottom:20},titleContainer:{minHeight:75,maxHeight:290,height:"calc(100% - 630px)",display:"flex",flexDirection:"column",justifyContent:"flex-end",background:"#e3f2fd"},inputContainer:{display:"flex",justifyContent:"center",paddingTop:50},personalInformationContainer:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:20,background:"#e3f2fd"},input:{width:250,paddingTop:5,paddingBottom:5},actionsWrapper:{display:"flex",justifyContent:"center",background:"#e3f2fd"},actionsContainer:{display:"flex",justifyContent:"space-between",paddingTop:50,background:"#e3f2fd",paddingBottom:20,width:300}})}));var qa=function(e){var t=e.setPatient,n=(e.patient,new URLSearchParams(Object(k.h)().search)),s=Object(i.useRef)((function(){var e=n.get("userName");e&&(E(e),ve(e))}));Object(i.useEffect)((function(){s.current()}),[]);var o=function(e){"Enter"===e.key&&(T?ye():ve(void 0))};Object(i.useEffect)((function(){return window.addEventListener("keydown",o),function(){window.removeEventListener("keydown",o)}}));var l=Object(c.useMutation)(La,{onCompleted:function(e){e&&e.patientLogIn&&t(e.patientLogIn)}}),d=Object(a.a)(l,1)[0],u=Aa(),j=Object(i.useState)(!1),b=Object(a.a)(j,2),O=b[0],h=b[1],m=Object(i.useState)(!1),f=Object(a.a)(m,2),p=f[0],x=f[1],g=Object(c.useLazyQuery)(bn,{fetchPolicy:"no-cache",onCompleted:function(e){if(e.queryUser.total>0){var t=e.queryUser.users[0];t.name&&$(t.name),t.gender&&V(t.gender),t.age&&Y(t.age),t.education&&te(t.education),t.jobStatus&&ce(t.jobStatus),t.marriageStatus&&de(t.marriageStatus),Oe(!0)}else $(""),V(""),Y(""),te(""),ce(""),de("")}}),v=Object(a.a)(g,2),C=v[0],y=v[1],w=y.loading,N=y.data,I=Object(i.useState)(!1),S=Object(a.a)(I,2),T=S[0],R=S[1],L=Object(i.useState)(""),A=Object(a.a)(L,2),q=A[0],E=A[1],z=Object(i.useState)(""),P=Object(a.a)(z,2),W=P[0],$=P[1],H=Object(i.useState)(""),Q=Object(a.a)(H,2),_=Q[0],V=Q[1],J=Object(i.useState)(""),K=Object(a.a)(J,2),G=K[0],Y=K[1],X=Object(i.useState)(""),Z=Object(a.a)(X,2),ee=Z[0],te=Z[1],ne=Object(i.useState)(""),ae=Object(a.a)(ne,2),re=ae[0],ce=ae[1],ie=Object(i.useState)(""),oe=Object(a.a)(ie,2),le=oe[0],de=oe[1],ue=Object(i.useState)(!1),je=Object(a.a)(ue,2),be=je[0],Oe=je[1],he=function(){Oe(!1)},me=Object(i.useState)(!1),fe=Object(a.a)(me,2),pe=fe[0],xe=fe[1],ge=function(){xe(!1)},ve=function(){var e=Object(nt.a)(tt.a.mark((function e(t){return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T){e.next=8;break}if(!q&&!t){e.next=7;break}return e.next=4,C({variables:{userName:t||q,limit:1,currentPageIndex:0}});case 4:R(!0),e.next=8;break;case 7:h(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=Object(k.g)(),ye=function(){var e=Object(nt.a)(tt.a.mark((function e(){return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!W){e.next=6;break}return e.next=3,d({variables:{input:{userName:q,education:ee,name:W,age:""!==G?Number(G):void 0,gender:_,jobStatus:re,marriageStatus:le}}});case 3:Ce.push("/user/home"),e.next=8;break;case 6:x(!0),xe(!0);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:u.root,children:[Object(r.jsx)(se,{}),T?w?Object(r.jsx)(U,{}):Object(r.jsxs)(r.Fragment,{children:[N&&N.queryUser.total>0?Object(r.jsx)("div",{className:u.titleContainer,children:Object(r.jsx)("div",{className:u.title,children:"\u8bf7\u6838\u5b9e\u60a8\u7684\u4e2a\u4eba\u4fe1\u606f"})}):Object(r.jsx)("div",{className:u.titleContainer,children:Object(r.jsx)("div",{className:u.title,children:"\u8bf7\u8f93\u5165\u60a8\u7684\u4e2a\u4eba\u4fe1\u606f"})}),Object(r.jsxs)("div",{className:u.personalInformationContainer,children:[Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(pa.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(D.a,{label:"\u59d3\u540d",className:u.input,required:!0,value:W,onChange:function(e){$(e.target.value)},error:!(!p||W)})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(va.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsxs)(Ft.a,{size:"small",className:u.input,children:[Object(r.jsx)(Yt.a,{children:"\u6027\u522b"}),Object(r.jsxs)(Xt.a,{color:"primary",label:"\u6027\u522b",onChange:function(e){V(e.target.value)},value:_,children:[Object(r.jsx)(Zt.a,{value:"\u7537",children:"\u7537"}),Object(r.jsx)(Zt.a,{value:"\u5973",children:"\u5973"})]})]})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(ya.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(D.a,{className:u.input,color:"primary",label:"\u5e74\u9f84",size:"small",type:"number",value:G,onChange:function(e){Y(e.target.value)}})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(Na.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsxs)(Ft.a,{size:"small",className:u.input,children:[Object(r.jsx)(Yt.a,{children:"\u5a5a\u59fb"}),Object(r.jsxs)(Xt.a,{color:"primary",value:le,onChange:function(e){de(e.target.value)},children:[Object(r.jsx)(Zt.a,{value:"\u5df2\u5a5a",children:"\u5df2\u5a5a"}),Object(r.jsx)(Zt.a,{value:"\u672a\u5a5a",children:"\u672a\u5a5a"})]})]})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(Sa.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsxs)(Ft.a,{size:"small",className:u.input,children:[Object(r.jsx)(Yt.a,{children:"\u6559\u80b2"}),Object(r.jsxs)(Xt.a,{color:"primary",value:ee,onChange:function(e){te(e.target.value)},children:[Object(r.jsx)(Zt.a,{value:"\u9ad8\u4e2d\u4ee5\u4e0b",children:"\u9ad8\u4e2d\u4ee5\u4e0b"}),Object(r.jsx)(Zt.a,{value:"\u5927\u4e2d\u4e13\u79d1",children:"\u5927\u4e2d\u4e13\u79d1"}),Object(r.jsx)(Zt.a,{value:"\u672c\u79d1",children:"\u672c\u79d1"}),Object(r.jsx)(Zt.a,{value:"\u7855\u58eb",children:"\u7855\u58eb"}),Object(r.jsx)(Zt.a,{value:"\u535a\u58eb",children:"\u535a\u58eb"})]})]})})]})}),Object(r.jsx)("div",{children:Object(r.jsxs)(ra.a,{container:!0,spacing:1,alignItems:"flex-end",children:[Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(Ta.a,{})}),Object(r.jsx)(ra.a,{item:!0,children:Object(r.jsx)(D.a,{color:"primary",label:"\u804c\u4e1a",size:"small",className:u.input,value:re,onChange:function(e){ce(e.target.value)}})})]})})]})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:u.titleContainer,children:Object(r.jsx)("div",{className:u.title,children:"\u8bf7\u8f93\u5165\u60a8\u7684\u95e8\u8bca\u53f7"})}),Object(r.jsx)("div",{className:u.inputContainer,children:Object(r.jsx)(D.a,{label:"\u95e8\u8bca\u53f7",InputProps:{startAdornment:Object(r.jsx)(xa.a,{position:"start",children:Object(r.jsx)(xt.a,{})})},value:q,onChange:function(e){E(e.target.value)},autoFocus:!0,error:!(!O||q)||void 0,helperText:O&&!q?"\u8bf7\u8f93\u5165\u60a8\u7684\u95e8\u8bca\u53f7":void 0})})]}),T?w?null:Object(r.jsx)("div",{className:u.actionsWrapper,children:Object(r.jsxs)("div",{className:u.actionsContainer,children:[Object(r.jsx)(F.a,{onClick:function(){R(!1)},children:"\u53d6\u6d88"}),Object(r.jsx)(F.a,{variant:"contained",color:"primary",onClick:ye,children:"\u786e\u5b9a"})]})}):Object(r.jsx)("div",{className:u.buttonContainer,children:Object(r.jsx)(F.a,{variant:"contained",color:"primary",endIcon:Object(r.jsx)(Oa.a,{}),onClick:function(){return ve(void 0)},children:"\u4e0b\u4e00\u6b65"})}),Object(r.jsx)(M.a,{open:be,autoHideDuration:6e3,onClose:he,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(r.jsx)(B.a,{onClose:he,severity:"success",variant:"filled",children:"\u6210\u529f\u8f7d\u5165\u60a8\u7684\u4e2a\u4eba\u4fe1\u606f"})}),Object(r.jsx)(M.a,{open:pe,autoHideDuration:6e3,onClose:ge,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(r.jsx)(B.a,{onClose:ge,severity:"error",variant:"filled",children:"\u59d3\u540d\u4e3a\u5fc5\u586b\u9879\uff01"})})]})},Da=n(445),Fa=n(432);function Ea(){var e=Object(d.a)(["\n  query CheckIfDoctorNameUnique($userName: String!) {\n    checkIfDoctorUserNameUnique(userName: $userName) {\n      result\n    }\n  }\n"]);return Ea=function(){return e},e}var za=Object(c.gql)(Ea()),Pa=n(79),Wa=function(e){var t=e.showSuccess,n=e.setShowSuccess,a=e.successMessage;return Object(r.jsx)(M.a,{open:t,onClose:function(){return n(!1)},anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(r.jsx)(B.a,{elevation:6,variant:"filled",severity:"success",onClose:function(){return n(!1)},children:a})})},Ua=Object(R.a)((function(e){return Object(L.a)({input:{display:"block",margin:5,paddingRight:5},inputContainer:{display:"flex",justifyContent:"center"}})})),Ma=function(e){var t=Ua(),n=e.isOpen,c=e.closeDialog,s=e.checkDoctorUserName,o=e.checkResult,l=e.addDoctor,d=e.refetchListData,u=Object(i.useState)(""),j=Object(a.a)(u,2),b=j[0],O=j[1],h=Object(i.useState)(""),m=Object(a.a)(h,2),f=m[0],p=m[1],x=Object(i.useState)(""),g=Object(a.a)(x,2),v=g[0],C=g[1],y=Object(i.useState)(""),w=Object(a.a)(y,2),N=w[0],I=w[1],S=Object(i.useState)(!1),k=Object(a.a)(S,2),T=k[0],R=k[1],L=Object(i.useState)(!1),A=Object(a.a)(L,2),q=A[0],E=A[1],z=Object(i.useState)(""),P=Object(a.a)(z,2),W=P[0],U=P[1],M=Object(i.useState)(!1),B=Object(a.a)(M,2),H=B[0],Q=B[1],_=Object(i.useCallback)(Object(Pa.a)(s,300),[s]);Object(i.useEffect)((function(){O(""),p(""),C(""),I(""),R(!1),Q(!1)}),[n]),Object(i.useEffect)((function(){o&&R(!o.checkIfDoctorUserNameUnique.result)}),[o]);var V=function(){var e=Object(nt.a)(tt.a.mark((function e(){var t,n;return tt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v===N){e.next=4;break}return U("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u76f8\u540c\uff01"),E(!0),e.abrupt("return");case 4:return e.next=6,l({variables:{input:{userName:b,name:f,password:v}}});case 6:n=e.sent,(null===(t=n.data)||void 0===t?void 0:t.addDoctor.result)&&(c(),d(),Q(!0));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(je.a,{open:n,onClose:c,"aria-labelledby":"form-dialog-title",children:[Object(r.jsx)(be.a,{id:"form-dialog-title",children:"\u6dfb\u52a0\u533b\u751f"}),Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(Je.a,{children:"\u8bf7\u8f93\u5165\u533b\u751f\u7684\u7528\u6237\u540d\u3001\u59d3\u540d\u548c\u5bc6\u7801\u3002"}),Object(r.jsx)(D.a,{autoFocus:!0,label:"\u7528\u6237\u540d",className:t.input,fullWidth:!0,required:!0,value:b,onChange:function(e){O(e.target.value),R(!1),_({variables:{userName:e.target.value}})},error:T||void 0,helperText:T?"\u6b64\u7528\u6237\u540d\u5df2\u7ecf\u88ab\u6ce8\u518c\uff01":void 0}),Object(r.jsx)(D.a,{label:"\u59d3\u540d",className:t.input,fullWidth:!0,required:!0,value:f,onChange:function(e){p(e.target.value)}}),Object(r.jsx)(D.a,{label:"\u5bc6\u7801",className:t.input,fullWidth:!0,required:!0,type:"password",value:v,onChange:function(e){C(e.target.value)}}),Object(r.jsx)(D.a,{label:"\u786e\u8ba4\u5bc6\u7801",className:t.input,fullWidth:!0,required:!0,type:"password",value:N,onChange:function(e){I(e.target.value)}})]}),Object(r.jsxs)(Ke.a,{children:[Object(r.jsx)(F.a,{onClick:c,children:"\u53d6\u6d88"}),Object(r.jsx)(F.a,{onClick:V,color:"primary",disabled:!(!T&&f&&b&&v&&N)||void 0,children:"\u6dfb\u52a0"})]}),Object(r.jsx)($,{showError:q,setShowError:E,errorMessage:W})]}),Object(r.jsx)(Wa,{showSuccess:H,setShowSuccess:Q,successMessage:"\u6210\u529f\u521b\u5efa\u8d26\u53f7"})]})},Ba=n(254),$a=n.n(Ba),Ha=n(129),Qa=Object(R.a)((function(e){return Object(L.a)({list:{margin:"20px 10px"},actionContainer:{margin:10,display:"flex",justifyContent:"space-between",alignItems:"center"},paginationContainer:{display:"flex",alignItems:"center"},totalNumberText:{marginRight:5},avatar:{backgroundColor:Ha.a[100],color:Ha.a[600]}})})),_a=function(){var e=Qa(),t=Object(c.useQuery)(Ve,{variables:{limit:5,currentPageIndex:0},fetchPolicy:"network-only"}),n=t.loading,o=t.data,l=t.refetch,d=Object(c.useLazyQuery)(za,{fetchPolicy:"no-cache"}),u=Object(a.a)(d,2),j=u[0],b=u[1].data,O=Object(c.useMutation)(N),h=Object(a.a)(O,1)[0],m=Object(i.useState)(0),f=Object(a.a)(m,2),p=f[0],x=f[1],g=Object(i.useState)(!1),v=Object(a.a)(g,2),C=v[0],y=v[1];return n||!o?Object(r.jsx)(U,{}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Pn,{text:"\u533b\u751f\u8d26\u53f7\u4fe1\u606f"}),Object(r.jsxs)("div",{className:e.actionContainer,children:[Object(r.jsx)(F.a,{variant:"contained",color:"primary",onClick:function(){y(!0)},children:"\u6dfb\u52a0\u533b\u751f"}),Object(r.jsxs)("div",{className:e.paginationContainer,children:[Object(r.jsxs)("span",{className:e.totalNumberText,children:["\u5171\u8ba1",o.doctorList.total,"\u4e2a\u8d26\u53f7"]}),Object(r.jsx)(Fa.a,{count:Math.ceil(o.doctorList.total/5),variant:"outlined",color:"primary",page:p+1,onChange:function(e,t){x(t-1),l({limit:5,currentPageIndex:t-1})}})]})]}),Object(r.jsx)(ke.a,{component:V.a,className:e.list,children:o.doctorList.admins.map((function(t,n){return Object(r.jsxs)(s.a.Fragment,{children:[Object(r.jsxs)(Re.a,{alignItems:"flex-start",children:[Object(r.jsx)(Le.a,{children:Object(r.jsx)(Da.a,{className:e.avatar,children:Object(r.jsx)($a.a,{})})}),Object(r.jsx)(Ae.a,{primary:"\u8d26\u53f7\u540d\uff1a".concat(t.userName),secondary:"\u59d3\u540d\uff1a".concat(t.name)})]},t.userName),n!==o.doctorList.admins.length-1&&Object(r.jsx)(_.a,{})]},t.userName)}))}),Object(r.jsx)(Ma,{isOpen:C,closeDialog:function(){y(!1)},checkDoctorUserName:j,checkResult:b,addDoctor:h,refetchListData:function(){l({limit:5,currentPageIndex:p})}})]})},Va=n(256),Ja=n(429),Ka=n(255),Ga=(n(352),new c.ApolloClient({uri:"/api",cache:new c.InMemoryCache,headers:{"X-CSRF_TOKEN":sessionStorage.getItem("token")||""}})),Ya={userName:null,token:null,didRequest:!1,catelogy:null},Xa={name:null,userName:null,didRequest:!1},Za=Object(R.a)((function(e){return Object(L.a)({root:{display:"flex",height:"100%"},contentContainer:{flexGrow:1,height:"100%"}})})),er="#1a73e8",tr=function(){var e=Za(),t=Object(i.useState)(Xa),n=Object(a.a)(t,2),s=n[0],o=n[1],l=Object(i.useState)(Ya),d=Object(a.a)(l,2),u=d[0],j=d[1],b=Object(c.useMutation)(v,{onCompleted:function(e){if(e&&e.doctorLogIn){var t=e.doctorLogIn,n=t.name,a=t.userName,r=t.didRequest;o({name:n,userName:a,didRequest:r})}}}),O=Object(a.a)(b,2),h=O[0],m=O[1].loading,f=Object(i.useRef)(h),p=Object(c.useMutation)(La,{onCompleted:function(e){e&&e.patientLogIn&&j(e.patientLogIn)}}),x=Object(a.a)(p,2),g=x[0],C=x[1].loading,y=Object(i.useRef)(g);if(Object(i.useEffect)((function(){f.current(),y.current()}),[]),m||!s.didRequest||C||!u.didRequest)return Object(r.jsx)(U,{});var w=!!s.userName;return Object(r.jsxs)(S.a,{children:[Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{exact:!0,path:"/"}),Object(r.jsx)(k.b,{exact:!0,path:"/user/prompt"}),Object(r.jsx)(k.b,{exact:!0,path:"/user/login"}),Object(r.jsx)(k.b,{path:"/user/home"}),Object(r.jsxs)(k.b,{path:"/doctor",children:[Object(r.jsx)(jt,{viewer:s,setViewer:o,type:"doctor"}),Object(r.jsx)(k.d,{children:Object(r.jsx)(k.b,{exact:!0,path:"/"})})]})]}),Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{exact:!0,path:"/login",children:Object(r.jsx)(Ie,{isAuthorized:w,setViewer:o,setDoctor:o,doctor:s})}),Object(r.jsx)(k.b,{exact:!0,path:"/doctor",render:function(e){var t=e.location;return Object(r.jsx)(k.a,{to:{pathname:"/login",state:{from:t}}})}}),Object(r.jsx)(z,{isAuthorized:w,path:"/user",exact:!0,children:Object(r.jsx)(ja,{setDoctor:o,doctor:s,logIn:f.current})}),Object(r.jsx)(z,{isAuthorized:w,path:"/user/prompt",exact:!0,children:Object(r.jsx)(ma,{})}),Object(r.jsx)(z,{isAuthorized:w,path:"/user/login",exact:!0,children:Object(r.jsx)(qa,{setPatient:j,patient:u})}),s.userName&&Object(r.jsx)(z,{isAuthorized:w,path:"/doctor/".concat(s.userName),children:Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(qt,{viewer:s,type:"doctor"}),Object(r.jsxs)("div",{className:e.contentContainer,children:[Object(r.jsx)(rt.a,{}),Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{exact:!0,path:"/doctor/".concat(s.userName),component:aa}),Object(r.jsx)(k.b,{exact:!0,path:"/doctor/".concat(s.userName,"/manage"),component:_a})]})]})]})}),u.userName&&Object(r.jsxs)(z,{isAuthorized:w,path:"/user",children:[Object(r.jsx)(jt,{viewer:u,setViewer:j,type:"user"}),Object(r.jsxs)(k.d,{children:[Object(r.jsx)(z,{isAuthorized:w,path:"/user/form",exact:!0,children:Object(r.jsx)(Gt,{})}),Object(r.jsx)(z,{isAuthorized:w,path:"/user",children:Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(qt,{viewer:u,type:"user"}),Object(r.jsxs)("div",{className:e.contentContainer,children:[Object(r.jsx)(rt.a,{}),Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{exact:!0,path:"/user/home",children:Object(r.jsx)(Ze,{patient:u})}),Object(r.jsx)(k.b,{exact:!0,path:"/user/report",component:un})]})]})]})})]})]}),Object(r.jsx)(z,{isAuthorized:w,path:"/user",children:Object(r.jsx)(r.Fragment,{})}),Object(r.jsx)(z,{isAuthorized:w,path:"/doctor",children:Object(r.jsx)(r.Fragment,{})}),Object(r.jsx)(k.b,{exact:!0,path:"/",children:Object(r.jsx)(k.a,{to:"/user"})})]})]})},nr=Object(Va.a)({palette:{primary:{light:"#6a9dff",main:er,dark:"#0045b5",contrastText:"#fff"}}},Ka.zhCN);l.a.render(Object(r.jsx)(c.ApolloProvider,{client:Ga,children:Object(r.jsx)(Ja.a,{theme:nr,children:Object(r.jsx)(tr,{})})}),document.getElementById("root")),I()}},[[353,1,2]]]);
//# sourceMappingURL=main.b8fbf186.chunk.js.map